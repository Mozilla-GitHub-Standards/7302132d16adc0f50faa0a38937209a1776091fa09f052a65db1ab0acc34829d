<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>replay - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/img/favicon.ico"/>
<script>window.settings = {"enableUsageDeliveryConfiguration":false,"enableNotebookNotifications":true,"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableDynamicAutoCompleteResourceLoading":false,"enableClusterMetricsUI":true,"allowWhitelistedIframeDomains":true,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableReservoirTableUI":true,"enableClearStateFeature":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"resetJobListOnConnect":true,"serverlessDefaultSparkVersion":"latest-stable-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","showS3TableImportOption":true,"maxEbsVolumesPerInstance":10,"enableRStudioUI":false,"isAdmin":true,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"sqlAclsEnabledMap":{"spark.databricks.acl.enabled":"true","spark.databricks.acl.sqlOnly":"true"},"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableWorkspaceBrowserSorting":true,"enableSentryLogging":true,"enableFindAndReplace":true,"disallowUrlImportExceptFromDocs":false,"defaultStandardClusterModel":{"cluster_name":"","node_type_id":"dev-tier-node","spark_version":"4.0.x-scala2.11","num_workers":0,"aws_attributes":{"first_on_demand":0,"availability":"ON_DEMAND","zone_id":"us-west-2c","spot_bid_price_percent":100},"autotermination_minutes":120,"default_tags":{"Vendor":"Databricks","Creator":"kkung065@uottawa.ca","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableBitbucketCloud":true,"shouldShowCommandStatus":true,"createTableInNotebookS3Link":{"url":"https://docs.databricks.com/_static/notebooks/data-import/s3.html","displayName":"S3","workspaceFileName":"S3 Example"},"sanitizeHtmlResult":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"useAutoscalingByDefault":false,"enableAzureToolbar":false,"fileStoreBase":"FileStore","enableEmailInAzure":false,"enableRLibraries":true,"enableTableAclsConfig":false,"enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"checkBeforeAddingAadUser":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"createTableInNotebookDBFSLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/dbfs.html","displayName":"DBFS","workspaceFileName":"DBFS Example"},"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"allowStyleInSanitizedHtml":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db6-rc-scala2.10","displayName":"Spark 2.1.1-db6 RC (Scala 2.10)","packageLabel":"spark-image-acbaa12090b02e7befad6397090829b7f4662fda18f5d8515a4d67312bcfd8ef","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-rc-scala2.10","displayName":"3.0 RC (Scala 2.10)","packageLabel":"spark-image-7d9200c8e481d37659be5847c60711fcbb1373e8c0f7224d02aa32585bbc4206","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.3.x-gpu-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-22756288786762d246bac1381e4f44610a4c2c3135c717c5ac3661822a723f1c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db5-rc-scala2.11","displayName":"Spark 2.1.1-db5 RC (Scala 2.11)","packageLabel":"spark-image-ad34023900d7edaae65bb610da459a6a9b72e267d580ca4af0f8a202eb4d622a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-7ce07ae16a775d917d6748d2075807565c157286f4f5957c1b77275b3b2a9bc4","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.10","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-86a9b375074f5afad339e70230ec0ec265c4cefbd280844785fab3bcde5869f9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"4.1.x-scala2.11","displayName":"4.1 beta (Scala 2.11)","packageLabel":"spark-image-e7709f6f1d90b147637f944dae94ea83da67be1111695ad310f9cc3ac8cef721","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS","SUPPORTS_RSTUDIO"]},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1, deprecated)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-cdfb5c6299de6a2f4f5b75e8def2d11faa2026a8354185434873ec4612916663","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 (Scala 2.10)","packageLabel":"spark-image-4efc0c94e152791782f2cb865ac1eb3c11985a2671a77e6ef930f9718851459d","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-ab147bdd6662fef83fa48e41d909aa045422585552758dc667f1971876c4486f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, Scala 2.11)","packageLabel":"spark-image-fc9368293e1b3b6c37181d7af3123a4b9de5f7fa03cfd6dfaa038753256380c9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.5.x-rc-scala2.11","displayName":"3.5 RC (Scala 2.11)","packageLabel":"spark-image-1bd1f5655bd8592121a992f7e2850903c894e70b1051aae0b22b40746ab78837","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-d613235f93e0f29838beb2079a958c02a192ed67a502192bc67a8a5f2fb37f35","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-rc-scala2.11","displayName":"4.0 RC (Scala 2.11)","packageLabel":"spark-image-3d04d769df9ac2649e4a9ff94bc0e000dba32785e147347e9cee28339f74498a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-gpu-scala2.11","displayName":"Latest stable (GPU, Scala 2.11)","packageLabel":"spark-image-b543c0700f83413b0055359ea9feaf285f2e2f3350fb7f301ea0e18b018b5cb5","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-f91cb0b3822c6641a9d346ef6c149118fb859b5e511ee01c31e958892ba23c7a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-25dac86138b91b354c5882419df5c45cd3695fb36b3a14ad63ff459cd7ae28b8","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.2.x-scala2.10","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-e50cbe4c0b0ad46930872eff4b69665890fd6a170e2b1a3e48c1cdea5823fd86","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-experimental-scala2.10","displayName":"Latest experimental (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-rc-gpu-scala2.11","displayName":"3.4.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-16c13081b2af658393292c92d2fa9a78c4e4eb34d10f6c53f0a5e31c78eeeb45","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-gpu-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, GPU, Scala 2.11)","packageLabel":"spark-image-b543c0700f83413b0055359ea9feaf285f2e2f3350fb7f301ea0e18b018b5cb5","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db4-rc-scala2.10","displayName":"Spark 2.1.1-db4 RC (Scala 2.10)","packageLabel":"spark-image-2e48642621076362dd599480653f479823c29abd6cf25a730ca07c6769265557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db5-rc-scala2.10","displayName":"Spark 2.1.1-db5 RC (Scala 2.10)","packageLabel":"spark-image-b61eb1b2fdca76763326d7652ef28973154ac43323149542fa2850f318b6cb66","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-62365f2d91529bc1128d8968f33d07f5b8d75cf7305de9455bc970e6e1fecbb4","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.11","displayName":"Latest RC (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-0394fe674a4830f4f41e9a13037f6d93d2dd2c1379888a87dcdf2fbfac15e765","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS","SUPPORTS_RSTUDIO"]},{"key":"latest-stable-scala2.11","displayName":"Latest stable (Scala 2.11)","packageLabel":"spark-image-fc9368293e1b3b6c37181d7af3123a4b9de5f7fa03cfd6dfaa038753256380c9","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.1-db6-rc-scala2.11","displayName":"Spark 2.1.1-db6 RC (Scala 2.11)","packageLabel":"spark-image-4826924720ecb5d65dcfc65266218ba280c4a5baa0c5dc599414fbdbd0c5519e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-0adabd34980ecfcbc6a48ac5c9e3a954cf5ec3a53a3300ae0e392c03299d89ca","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.11","displayName":"3.3 RC (Scala 2.11)","packageLabel":"spark-image-4a6167d669013113144de360ccd0b11be67e6b5cb4021a22d82423431ec2e4b1","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-rc-scala2.11","displayName":"3.4 RC (Scala 2.11)","packageLabel":"spark-image-5b306709d7fb9ed16e0de1039d5827e89a50000dbb0906a6533e37eca6afa5f1","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"4.1.x-rc-scala2.11","displayName":"4.1 RC (Scala 2.11)","packageLabel":"spark-image-e7709f6f1d90b147637f944dae94ea83da67be1111695ad310f9cc3ac8cef721","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS","SUPPORTS_RSTUDIO"]},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-rc-gpu-scala2.11","displayName":"3.3.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-5e718a9c829689ffff153681e96fa5d52682bffefea82b59b29f14167a13b684","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"next-major-version-scala2.11","displayName":"Next major version (4.0 snapshot, Scala 2.11)","packageLabel":"spark-image-04bb47b0bae8165f760972376ce05083bc6102645f3f3851cd1cdf9cba13d6fe","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.1-db4-rc-scala2.11","displayName":"Spark 2.1.1-db4 RC (Scala 2.11)","packageLabel":"spark-image-3c15b14dbe5e2c2032a6d6c170d67fdbbeb3a7dfde485684882dc8e2bdca7842","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-fe8300ae2b3bf12c79ce76d7e9d2d03995e58d1497cfb6c0d3172efb630cb2df","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"4.0.x-rc-gpu-scala2.11","displayName":"4.0 RC (GPU, Scala 2.11)","packageLabel":"spark-image-a3f5758654e4514d2f830de7183ca85664b3a14f8401d51e051cd731003c04db","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.1.x-gpu-scala2.11","displayName":"4.1 beta (GPU, Scala 2.11)","packageLabel":"spark-image-41ffc8bf18d47e93c4636175de8bec0240d4088581f0c05aeeb9d30886542acb","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_RSTUDIO"]},{"key":"3.5.x-scala2.10","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.10","displayName":"3.3 RC (Scala 2.10)","packageLabel":"spark-image-2e3a32fca0b83631ec599a6658569e6aa9cfc0feb2c197093dbcab5c60c1f667","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-0112f566715b00d5aceb1b98543285bcb3a0f38174b86abd1c096c3e861043eb","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.10","displayName":"Latest RC (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.10","displayName":"[DEPRECATED] Latest stable (Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-rc-scala2.10","displayName":"3.4 RC (Scala 2.10)","packageLabel":"spark-image-fad33edf3589f3c1d60815ce5ee56503cf22c325571de773a5a785871571bcca","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.1.x-rc-scala2.10","displayName":"3.1 RC (Scala 2.10)","packageLabel":"spark-image-e92866a9dda6b7970b4f7c63a25d2981d9e70cc8e7cc9897c9328af2d2f574a7","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-07da7d24ad964d7a43f53bd9feac55de7df890ef6e5f6bac8975fb7aa3e2a0a7","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-gpu-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-66d1366768039140a9f5409f3bab414cb7477ebd8d4bbf8b32cb885120f9f705","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1, deprecated)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-gpu-scala2.11","displayName":"Latest experimental (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-65e44f2f31b27757c9e2daf411737a838933c7a53ee0f095b7a2bfd0f3a0a27c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_RSTUDIO"]},{"key":"3.2.x-rc-scala2.11","displayName":"3.2 RC (Scala 2.11)","packageLabel":"spark-image-116c72cfa5fd44aa565c8d4787f0505ebab0b4b05cb095654576e9354c4fcfe4","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-2fdca45e0fcac7081823a5faef4f25d6fc909d11c44eca82e1dd18e9d2ef2859","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-cdfb5c6299de6a2f4f5b75e8def2d11faa2026a8354185434873ec4612916663","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.1.x-scala2.11","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-0d3a99d46a4c55642850b5eba9aad3b56ffb9adbe8c8893403eba834399960fc","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-1f615934d3e248da8dcfb3e03bd8d92e933a17845fedb7cce12af2a0220ba6a2","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-rc-scala2.11","displayName":"3.0 RC (Scala 2.11)","packageLabel":"spark-image-f309deb4f730b352c1d99479adcce095c1f9f4d20c9e811daa1296e36b56a514","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.5.x-rc-gpu-scala2.11","displayName":"3.5.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-12f6454a262a7a7654b7632142102d80c3641e10c6dcb0938edd5fb81a859547","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.1.x-scala2.10","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-c6b477859faf291f56ac2dcbe6f6693d60e403c12dfcac58892b4014614363c3","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-46cc39a9afa43fbd7bfa9f4f5ed8d23f658cd0b0d74208627243222ae0d22f8d","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"next-major-version-gpu-scala2.11","displayName":"Next major version (4.0 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-41e21a0db3b77bc857f10358917ccbf5fbd85290e8429c2176a5fc7a29ce4f18","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-gpu-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, GPU, Scala 2.11)","packageLabel":"spark-image-7a1e78fbfc4d1645e7478daa28377389b900aec38764df46bd836c1a9925499b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1, deprecated)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-c8547fab0cc66b918f9a64c7e35532de209d0d0e06da6078ad787ec718b37e7b","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 (Scala 2.11)","packageLabel":"spark-image-0067951c626cad90625cce4d2dcf3e00a1029375f8e5470d2330036d0d3c505f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-b512ba976616af10269438701339a9bd5a97cc386737c6ecffdda5fb31c3cf20","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.1.x-rc-scala2.11","displayName":"3.1 RC (Scala 2.11)","packageLabel":"spark-image-7516391610fb7ad114419e9f5827f1f399ec6123a369252a2c0464ad328ec38c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"4.1.x-rc-gpu-scala2.11","displayName":"4.1 RC (GPU, Scala 2.11)","packageLabel":"spark-image-41ffc8bf18d47e93c4636175de8bec0240d4088581f0c05aeeb9d30886542acb","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_RSTUDIO"]},{"key":"latest-experimental-scala2.11","displayName":"Latest experimental (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-0394fe674a4830f4f41e9a13037f6d93d2dd2c1379888a87dcdf2fbfac15e765","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS","SUPPORTS_RSTUDIO"]},{"key":"3.2.x-scala2.11","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-3b22b5c8d5577281bcca8dd6ef07553fb32b3b99ab977f8bdb7238f850ece887","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-2fdca45e0fcac7081823a5faef4f25d6fc909d11c44eca82e1dd18e9d2ef2859","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-0ea14d4a8a71de38872dd398b1139d55302680cfe3e9da217576c8304cd19b24","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-gpu-scala2.11","displayName":"Latest RC (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-65e44f2f31b27757c9e2daf411737a838933c7a53ee0f095b7a2bfd0f3a0a27c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_RSTUDIO"]},{"key":"3.5.x-rc-scala2.10","displayName":"3.5 RC (Scala 2.10)","packageLabel":"spark-image-3ad503107c99149a231e897422c4d79ba5a6928267b852e0a0394b9a2129efac","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.4.x-scala2.10","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-867d7300605c0c54b2b1394d1bba7b88b28ed5841b3575253cded34db6ce6454","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.2.x-rc-scala2.10","displayName":"3.2 RC (Scala 2.10)","packageLabel":"spark-image-f9c83b6281f765d661941ec720dc2071df84326ae90e40ba7d7702c6122c7947","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]}],"enablePresentationMode":false,"enableClearStateAndRunAll":true,"enableTableAclsByTier":false,"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"jobsUnreachableThresholdMillis":60000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"createTableInNotebookImportedFileLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/imported-file.html","displayName":"Imported File","workspaceFileName":"Imported File Example"},"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","showDbuPricing":true,"databricksDocsBaseHostname":"docs.databricks.com","defaultNodeTypeToPricingUnitsMap":{"Standard_E64s_v3":16,"r3.2xlarge":2,"i3.4xlarge":4,"class-node":1,"m4.2xlarge":1.5,"Standard_D11_v2":0.5,"r4.xlarge":1,"m4.4xlarge":3,"Standard_DS5_v2":3,"Standard_D2s_v3":0.5,"Standard_DS4_v2_Promo":1.5,"Standard_DS14":4,"Standard_DS11_v2_Promo":0.5,"r4.16xlarge":16,"Standard_NC6":2,"Standard_DS11":0.5,"Standard_D2_v3":0.5,"Standard_DS14_v2_Promo":4,"Standard_D64s_v3":12,"p2.8xlarge":16,"m4.10xlarge":8,"Standard_D8s_v3":1.5,"Standard_E32s_v3":8,"Standard_DS3":0.75,"Standard_DS2_v2":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"Standard_L8s":2,"Standard_D13_v2":2,"Standard_DS13_v2_Promo":2,"Standard_E4s_v3":1,"Standard_D3_v2":0.75,"Standard_NC24":8,"Standard_NC24r":8,"Standard_DS15_v2":5,"Standard_D16s_v3":3,"Standard_D5_v2":3,"Standard_E8s_v3":2,"Standard_DS2_v2_Promo":0.5,"c3.8xlarge":4,"Standard_D4_v3":0.75,"Standard_E2s_v3":0.5,"Standard_D32_v3":6,"Standard_DS3_v2":0.75,"r3.4xlarge":4,"Standard_DS4":1.5,"i2.4xlarge":6,"Standard_DS3_v2_Promo":0.75,"m4.xlarge":0.75,"r4.8xlarge":8,"Standard_D14_v2":4,"Standard_H16":4,"Standard_NC12":4,"Standard_DS14_v2":4,"r4.large":0.5,"Standard_D15_v2":5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"Standard_D12_v2":1,"i3.large":0.75,"memory-optimized":1,"m4.large":0.4,"Standard_D16_v3":3,"Standard_F4s":0.5,"p2.16xlarge":24,"i3.8xlarge":8,"Standard_D32s_v3":6,"i3.16xlarge":16,"Standard_DS12_v2":1,"Standard_L32s":8,"Standard_D4s_v3":0.75,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS12_v2_Promo":1,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1,"Standard_F16s":2,"c4.2xlarge":1,"Standard_L16s":4,"i2.xlarge":1.5,"Standard_DS2":0.5,"compute-optimized":1,"c4.4xlarge":2,"Standard_DS5_v2_Promo":3,"Standard_D64_v3":12,"Standard_D2_v2":0.5,"Standard_D8_v3":1.5,"i3.2xlarge":2,"Standard_E16s_v3":4,"Standard_F8s":1,"c3.4xlarge":2,"Standard_D4_v2":1.5,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"Standard_DS4_v2":1.5,"c4.8xlarge":4,"i3.xlarge":1,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"tableFilesBaseFolder":"/tables","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableClusterAppsUIOnServerless":false,"enableEBSVolumesUI":false,"homePageWelcomeMessage":"Welcome to ","metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.69.54","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"useAADLogin":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":true,"enableStrongPassword":false,"showReleaseNote":true,"displayDefaultContainerMemoryGB":6,"broadenedEditPermission":false,"disableS3TableImport":false,"enableArrayParamsEdit":true,"deploymentMode":"production","useSpotForWorkers":true,"removePasswordInAccountSettings":false,"preferStartTerminatedCluster":false,"enableUserInviteWorkflow":true,"createTableConnectorOptionLinks":[{"url":"https://docs.databricks.com/_static/notebooks/redshift.html","displayName":"Amazon Redshift","workspaceFileName":"Amazon Redshift Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-kinesis.html","displayName":"Amazon Kinesis","workspaceFileName":"Amazon Kinesis Example"},{"url":"https://docs.databricks.com/_static/notebooks/data-import/jdbc.html","displayName":"JDBC","workspaceFileName":"JDBC Example"},{"url":"https://docs.databricks.com/_static/notebooks/cassandra.html","displayName":"Cassandra","workspaceFileName":"Cassandra Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-etl-kafka.html","displayName":"Kafka","workspaceFileName":"Kafka Example"},{"url":"https://docs.databricks.com/_static/notebooks/redis.html","displayName":"Redis","workspaceFileName":"Redis Example"},{"url":"https://docs.databricks.com/_static/notebooks/elasticsearch.html","displayName":"Elasticsearch","workspaceFileName":"Elasticsearch Example"}],"enableStaticNotebooks":true,"enableNewLineChart":true,"sandboxForUrlSandboxFrame":"allow-scripts allow-popups allow-popups-to-escape-sandbox allow-forms","enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterEdit":true,"enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"enableCreateClusterOnAttach":true,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"defaultMinWorkers":2,"commandStatusDebounceMaxWait":1000,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableExperimentalCharts":false,"defaultMaxWorkers":8,"enableWorkspaceAclsConfig":false,"serverlessRunPythonAsLowPrivilegeUser":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":true,"enableNewDashboardViews":true,"enableJobListPermissionFilter":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"4.0.x-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, Scala 2.11)","packageLabel":"spark-image-fc9368293e1b3b6c37181d7af3123a4b9de5f7fa03cfd6dfaa038753256380c9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},"enableNewLineChartParams":false,"deprecatedEnableStructuredDataAcls":false,"enableCustomSpotPricing":false,"enableRStudioFreeUI":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":120,"useDevTierHomePage":true,"disableExportNotebook":false,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","commandStatusDebounceInterval":100,"showSqlEndpoints":false,"enableNotebookDatasetInfoView":true,"defaultTagKeys":{"CLUSTER_NAME":"ClusterName","VENDOR":"Vendor","CLUSTER_TYPE":"ResourceClass","CREATOR":"Creator","CLUSTER_ID":"ClusterId"},"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","azurePortalLink":"https://portal.azure.com","cloud":"AWS","customSparkVersionPrefix":"custom:","disallowAddingAdmins":true,"enableSparkConfUI":true,"enableClusterEventsUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","defaultServerlessClusterModel":{"cluster_name":"","node_type_id":"i3.2xlarge","spark_version":"latest-stable-scala2.11","num_workers":null,"enable_jdbc_auto_start":true,"custom_tags":{"ResourceClass":"Serverless"},"autoscale":{"min_workers":2,"max_workers":20},"spark_conf":{"spark.databricks.cluster.profile":"serverless","spark.databricks.repl.allowedLanguages":"sql,python,r"},"aws_attributes":{"ebs_volume_count":null,"availability":"ON_DEMAND","first_on_demand":1,"ebs_volume_type":null,"spot_bid_price_percent":100,"zone_id":"us-west-2c","ebs_volume_size":null},"autotermination_minutes":0,"enable_elastic_disk":false,"default_tags":{"Vendor":"Databricks","Creator":"kkung065@uottawa.ca","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableOrgSwitcherUI":true,"bitbucketCloudBaseApiV2Url":"https://api.bitbucket.org/2.0","clustersLimit":1,"enableJdbcImport":true,"enableClusterAppsUIOnNormalClusters":false,"enableElasticDisk":false,"logfiles":"logfiles/","enableRelativeNotebookLinks":true,"enableMultiSelect":true,"homePageLogo":"login/databricks_logoTM_rgb_TM.svg","enableWebappSharding":true,"enableNotebookParamsEdit":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"separateTableForJobClusters":true,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableRServerless":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"showVersion":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"","clusterTagReservedPrefixes":[],"tableAclsEnabledMap":{"spark.databricks.acl.dfAclsEnabled":"true","spark.databricks.repl.allowedLanguages":"python,sql"},"showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","databricksDocsNotebookPathPrefix":"^https://docs\\.databricks\\.com/_static/notebooks/.+$","serverlessAttachEbsVolumesByDefault":false,"enableTokensConfig":true,"allowFeedbackForumAccess":true,"enablePythonVersionUI":true,"enableImportFromUrl":true,"allowDisplayHtmlByUrl":true,"enableTokens":false,"enableMiniClusters":true,"enableNewJobList":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"loginLogo":"/login/databricks_logoTM_rgb_TM.svg","useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/","enableSpotClusterType":true,"enableSparkPackages":true,"checkAadUserInWorkspaceTenant":false,"dynamicSparkVersions":true,"useIframeForHtmlResult":false,"enableClusterTagsUIByTier":false,"enableUserPromptForPendingRpc":true,"enableNotebookHistoryUI":true,"addWhitespaceAfterLastNotebookCell":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"maxImportFileVersion":5,"enableEBSVolumesUIByTier":false,"enableTableAclService":true,"removeSubCommandCodeWhenExport":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"showResultsFromExternalSearchEngine":true,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":2904933995152615,"name":"replay","language":"python","commands":[{"version":"CommandV1","origId":951645590912523,"guid":"5084c7d9-a439-4f9b-9126-1721638903a9","subtype":"command","commandType":"auto","position":2.0,"command":"import pandas as pd\nimport numpy as np\nimport json\nfrom __future__ import division","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1523303845793,"submitTime":1523303845503,"finishTime":1523303846177,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"b3bcd1a6-620d-42ec-adce-32b8259660aa"},{"version":"CommandV1","origId":951645590912524,"guid":"d7758cfe-770a-4a4d-9575-547a47800d09","subtype":"command","commandType":"auto","position":2.5,"command":"Total calls: 113714009\n% of calls that are to a session replay provider: 3.7% (4211829/113714009)\nTotal calls with an unique base location: 87325\n% of sites(base url) that uses a session replay provider: 5.6% (4858/87325)\n.ru:\n  Total calls with a .ru location: 6949846\n  calls to a .ru url % : 6.1% (6949846/113714009)\n  Total calls with an unique base .ru location: 2492\n  % of .ru sites(base url): 2.9% (2492/87325)\nSession Replay:\n  Total calls: 4211829\n  Total unique base locations: 4858   \n  .ru\n    Total calls to .ru: 1940300\n    Total .ru sites (unique base locations): 1634\n    given a session replay calls, % it is a .ru location: 46.1% (1940300/4211829)\n    given a call with a .ru location, % it is a session replay call:  27.9% (1940300/6949846)\n    given a .ru site, % it uses a session replay provider: 65.6% (1634/2492)\n    given a site that uses a session replay provider, % it is .ru: 33.6% (1634/4858)\n  Http vs Https:\n    script_https + location_http = 942662\n    script_https + location_https = 2110433\n    script_http + location_http = 1158734\n    surprising there are no script_https + location_http\n    script:\n      http: 942662\n      https: 3053095\n      http % on a session replay call: 23.6% (942662/(942622+3053095))\n    location:\n      http: 2101396\n      https: 2110433\n      http % on a session replay calls location: 49.9% (2101396/(2101396+2110433))","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;command-313033179106625&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">1</span>\n<span class=\"ansiyellow\">    Total calls: 113714009</span>\n<span class=\"ansigrey\">              ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1522949394552,"submitTime":1522949394552,"finishTime":1522949394639,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7e4e7f48-ef53-41d7-b158-39c36f06e5e5"},{"version":"CommandV1","origId":951645590912525,"guid":"35081ff7-a127-43e6-896c-040f340a801d","subtype":"command","commandType":"auto","position":3.0,"command":"%md **This analysis aim to look at known sites which calls known session replay sites to see if we can find signs of session replay activity.**\n\nSession replay providers are services that offer websites a way to track their users - from how they interact with the site to what searches they performed and input they provided. Some session replay providers may even record personal information such as personal addresses and credit card information.\n\nThe list of session replay sites comes from the  [**Princeton WebTAP project**](https://webtransparency.cs.princeton.edu/no_boundaries/session_replay_sites.html), which listed sites within the Alexa top 10,000 that show signs of session replay scripts.\n\nWith a sample size of 2494 base sites: 90 were found to use session replay calls.\nHowever when we boil it down to the base url the sample size reduced to 1136 unique base urls and 62 of which uses session replay. And an overall 3.15% of all calls were to a session_replay provider.\n\n**Of the sites that were found to be using session replay calls, 35.5% had a .ru suffix. Which is significantly higher than it's distribution in the overall urls captured, 4.0%. Additionally, 27/45 of the .ru sites were using a session replay site. That is 60% of all .ru sites tracked uses session replay scripts compared to the overall 62/1136, 5.5% of all domains using session replay scripts. With the .ru sites we track, it has a 20x more probability of using session replay_scripts versus non .ru sites.**\n\n**When considering http vs https distributions: sites that uses session replay calls has a higher 53.3% http distribution vs the overall 31.3% http distribution**\n\nSites that uses session_replay scripts:\n\n '24smi.org',\n '>B:@KBK9C@>:.@D',\n 'base.garant.ru',\n 'dnevnik.ru',\n 'dugtor.ru',\n 'football.ua',\n 'getcourse.ru',\n 'hdrezka.ag',\n 'hh.ru',\n 'ibizlife.com',\n 'lady.nur.kz',\n 'mp3party.net',\n 'my-shop.ru',\n 'netbarg.com',\n 'nl.justporno.tv',\n 'out.pladform.ru',\n 'pagseguro.uol.com.br',\n 'porn555.com',\n 'povar.ru',\n 'rutube.ru',\n 'seasonvar.ru',\n 'serienstream.to',\n 'sprashivai.ru',\n 'steam.softonic.com',\n 'studfiles.net',\n 'tap.az',\n 'top.mail.ru',\n 'torrent-filmi.net',\n 'trinixy.ru',\n 'www.autodesk.com',\n 'www.avito.ru',\n 'www.azet.sk',\n 'www.bamilo.com',\n 'www.banggood.com',\n 'www.bbcgoodfood.com',\n 'www.cardinalcommerce.com',\n 'www.casadellibro.com',\n 'www.eleman.net',\n 'www.eurosport.fr',\n 'www.fastweb.it',\n 'www.fotocasa.es',\n 'www.geekbuying.com',\n 'www.gl5.ru',\n 'www.jbhifi.com.au',\n 'www.kommersant.ru',\n 'www.labirint.ru',\n 'www.maam.ru',\n 'www.maxcdn.com',\n 'www.msu.ru',\n 'www.net-a-porter.com',\n 'www.newchic.com',\n 'www.rbcplus.ru',\n 'www.sports.ru',\n 'www.stackoverflowbusiness.com',\n 'www.stranamam.ru',\n 'www.templatemonster.com',\n 'www.the-star.co.ke',\n 'www.thermofisher.com',\n 'www.twirpx.com',\n 'www.universal.org',\n 'www.vseinstrumenti.ru',\n 'xhamster.com'\n\nCorrelation between call symbols and wheter or not the call is a session replay call is also attempted, however the correlation weren't very strong - with the highest being **window.navigator.plugins[Shockwave Flash].version** at 0.105229\n\n\n","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"d92090c0-4dce-4af7-b01b-b13a7116d509"},{"version":"CommandV1","origId":951645590912526,"guid":"c06b7432-18a0-4f10-a6a3-078178ffd73c","subtype":"command","commandType":"auto","position":4.0,"command":"%md Get the list of known session replay providers","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"4d148c24-194b-4995-abac-a30d53c5013a"},{"version":"CommandV1","origId":951645590912527,"guid":"0efab6e6-0623-4c77-9f85-8c866f542780","subtype":"command","commandType":"auto","position":5.0,"command":"def get_replay_sites():\n    \"\"\"Loads a list of session replay providers from the Princeton WebTAP project,\n    which listed sites within the Alexa top 10,000 that show signs of session replay scripts.\n    \"\"\"\n    session_replay = spark.sql(\"SELECT DISTINCT third_party FROM sr_site_list_csv\")\n    rows_array = session_replay.collect()\n    return [row.third_party for row in rows_array]","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1523303852702,"submitTime":1523303852677,"finishTime":1523303852725,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"5517e4bc-b990-4527-8d5f-25758ade2905"},{"version":"CommandV1","origId":951645590912528,"guid":"9a7b5cc0-9805-4ff6-a0bf-c0afe1616989","subtype":"command","commandType":"auto","position":6.0,"command":"replay_sites = get_replay_sites()","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 1 in stage 31.0 failed 1 times, most recent failure: Lost task 1.0 in stage 31.0 (TID 2518, localhost, executor driver): org.apache.spark.repl.RemoteClassLoaderError: org/apache/spark/sql/catalyst/expressions/Object.class","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2904933995152621&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>replay_sites <span class=\"ansiyellow\">=</span> get_replay_sites<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">&lt;command-2904933995152620&gt;</span> in <span class=\"ansicyan\">get_replay_sites</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      4</span>     &quot;&quot;&quot;\n<span class=\"ansigreen\">      5</span>     session_replay <span class=\"ansiyellow\">=</span> spark<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;SELECT DISTINCT third_party FROM sr_site_list_csv&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 6</span><span class=\"ansiyellow\">     </span>rows_array <span class=\"ansiyellow\">=</span> session_replay<span class=\"ansiyellow\">.</span>collect<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span>     <span class=\"ansigreen\">return</span> <span class=\"ansiyellow\">[</span>row<span class=\"ansiyellow\">.</span>third_party <span class=\"ansigreen\">for</span> row <span class=\"ansigreen\">in</span> rows_array<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">collect</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">    452</span>         <span class=\"ansired\"># Default path used in OSS Spark / for non-DF-ACL clusters:</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    453</span>         <span class=\"ansigreen\">with</span> SCCallSiteSync<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_sc<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">as</span> css<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 454</span><span class=\"ansiyellow\">             </span>port <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>collectToPython<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    455</span>         <span class=\"ansigreen\">return</span> list<span class=\"ansiyellow\">(</span>_load_from_socket<span class=\"ansiyellow\">(</span>port<span class=\"ansiyellow\">,</span> BatchedSerializer<span class=\"ansiyellow\">(</span>PickleSerializer<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    456</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    317</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    318</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 319</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o825.collectToPython.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 1 in stage 31.0 failed 1 times, most recent failure: Lost task 1.0 in stage 31.0 (TID 2518, localhost, executor driver): org.apache.spark.repl.RemoteClassLoaderError: org/apache/spark/sql/catalyst/expressions/Object.class\n\tat org.apache.spark.repl.ExecutorClassLoader$$anon$1.toClassNotFound(ExecutorClassLoader.scala:119)\n\tat org.apache.spark.repl.ExecutorClassLoader$$anon$1.read(ExecutorClassLoader.scala:107)\n\tat java.io.FilterInputStream.read(FilterInputStream.java:107)\n\tat org.apache.spark.repl.ExecutorClassLoader.readAndTransformClass(ExecutorClassLoader.scala:223)\n\tat org.apache.spark.repl.ExecutorClassLoader.findClassLocally(ExecutorClassLoader.scala:177)\n\tat org.apache.spark.repl.ExecutorClassLoader.findClass(ExecutorClassLoader.scala:81)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:411)\n\tat org.apache.spark.util.ParentClassLoader.loadClass(ParentClassLoader.scala:34)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\tat org.apache.spark.util.ParentClassLoader.loadClass(ParentClassLoader.scala:30)\n\tat java.lang.Class.forName0(Native Method)\n\tat java.lang.Class.forName(Class.java:348)\n\tat org.codehaus.janino.ClassLoaderIClassLoader.findIClass(ClassLoaderIClassLoader.java:83)\n\tat org.codehaus.janino.IClassLoader.loadIClass(IClassLoader.java:288)\n\tat org.codehaus.janino.UnitCompiler.findTypeByName(UnitCompiler.java:7611)\n\tat org.codehaus.janino.UnitCompiler.getReferenceType(UnitCompiler.java:5906)\n\tat org.codehaus.janino.UnitCompiler.getReferenceType(UnitCompiler.java:5751)\n\tat org.codehaus.janino.UnitCompiler.getType2(UnitCompiler.java:5732)\n\tat org.codehaus.janino.UnitCompiler.access$13200(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$18.visitReferenceType(UnitCompiler.java:5668)\n\tat org.codehaus.janino.UnitCompiler$18.visitReferenceType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.Java$ReferenceType.accept(Java.java:3356)\n\tat org.codehaus.janino.UnitCompiler.getType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.UnitCompiler.getType2(UnitCompiler.java:6007)\n\tat org.codehaus.janino.UnitCompiler.access$13000(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$18.visitArrayType(UnitCompiler.java:5666)\n\tat org.codehaus.janino.UnitCompiler$18.visitArrayType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.Java$ArrayType.accept(Java.java:3425)\n\tat org.codehaus.janino.UnitCompiler.getType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.UnitCompiler.access$1200(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$32.getParameterTypes2(UnitCompiler.java:9326)\n\tat org.codehaus.janino.IClass$IInvocable.getParameterTypes(IClass.java:853)\n\tat org.codehaus.janino.IClass$IMethod.getDescriptor2(IClass.java:1084)\n\tat org.codehaus.janino.IClass$IInvocable.getDescriptor(IClass.java:865)\n\tat org.codehaus.janino.IClass.getIMethods(IClass.java:211)\n\tat org.codehaus.janino.IClass.getIMethods(IClass.java:200)\n\tat org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:439)\n\tat org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:420)\n\tat org.codehaus.janino.UnitCompiler.access$400(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:374)\n\tat org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:369)\n\tat org.codehaus.janino.Java$AbstractPackageMemberClassDeclaration.accept(Java.java:1309)\n\tat org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:369)\n\tat org.codehaus.janino.UnitCompiler.compileUnit(UnitCompiler.java:345)\n\tat org.codehaus.janino.SimpleCompiler.compileToClassLoader(SimpleCompiler.java:396)\n\tat org.codehaus.janino.ClassBodyEvaluator.compileToClass(ClassBodyEvaluator.java:311)\n\tat org.codehaus.janino.ClassBodyEvaluator.cook(ClassBodyEvaluator.java:229)\n\tat org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:196)\n\tat org.codehaus.commons.compiler.Cookable.cook(Cookable.java:91)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.org$apache$spark$sql$catalyst$expressions$codegen$CodeGenerator$$doCompile(CodeGenerator.scala:1042)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1118)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1115)\n\tat com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3522)\n\tat com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2315)\n\tat com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2278)\n\tat com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2193)\n\tat com.google.common.cache.LocalCache.get(LocalCache.java:3932)\n\tat com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3936)\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4806)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.compile(CodeGenerator.scala:988)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:435)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:389)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:32)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator.generate(CodeGenerator.scala:968)\n\tat org.apache.spark.sql.catalyst.expressions.UnsafeProjection$.create(Projection.scala:130)\n\tat org.apache.spark.sql.catalyst.expressions.UnsafeProjection$.create(Projection.scala:140)\n\tat org.apache.spark.sql.execution.exchange.ShuffleExchangeExec$.org$apache$spark$sql$execution$exchange$ShuffleExchangeExec$$getPartitionKeyExtractor$1(ShuffleExchangeExec.scala:245)\n\tat org.apache.spark.sql.execution.exchange.ShuffleExchangeExec$$anonfun$3.apply(ShuffleExchangeExec.scala:258)\n\tat org.apache.spark.sql.execution.exchange.ShuffleExchangeExec$$anonfun$3.apply(ShuffleExchangeExec.scala:257)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:836)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:836)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:332)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:296)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:96)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:53)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:110)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:349)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: java.io.IOException: Connection reset by peer\n\tat sun.nio.ch.FileDispatcherImpl.read0(Native Method)\n\tat sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)\n\tat sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)\n\tat sun.nio.ch.IOUtil.read(IOUtil.java:192)\n\tat sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)\n\tat io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:221)\n\tat io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:899)\n\tat io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:275)\n\tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:119)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:643)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:566)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:480)\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:442)\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:131)\n\tat io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:144)\n\t... 1 more\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1683)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1671)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1670)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1670)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:931)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:931)\n\tat scala.Option.foreach(Option.scala:257)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:931)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1903)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1854)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1842)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:733)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2114)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2211)\n\tat org.apache.spark.sql.execution.collect.Collector.runSparkJobs(Collector.scala:206)\n\tat org.apache.spark.sql.execution.collect.Collector.collect(Collector.scala:241)\n\tat org.apache.spark.sql.execution.collect.Collector$.collect(Collector.scala:64)\n\tat org.apache.spark.sql.execution.collect.Collector$.collect(Collector.scala:70)\n\tat org.apache.spark.sql.execution.SparkPlan.executeCollectResult(SparkPlan.scala:264)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply$mcI$sp(Dataset.scala:2938)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply(Dataset.scala:2936)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply(Dataset.scala:2936)\n\tat org.apache.spark.sql.execution.SQLExecution$.withCustomExecutionEnv(SQLExecution.scala:89)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:127)\n\tat org.apache.spark.sql.Dataset.withNewExecutionId(Dataset.scala:3007)\n\tat org.apache.spark.sql.Dataset.collectToPython(Dataset.scala:2936)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:380)\n\tat py4j.Gateway.invoke(Gateway.java:293)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:226)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: org.apache.spark.repl.RemoteClassLoaderError: org/apache/spark/sql/catalyst/expressions/Object.class\n\tat org.apache.spark.repl.ExecutorClassLoader$$anon$1.toClassNotFound(ExecutorClassLoader.scala:119)\n\tat org.apache.spark.repl.ExecutorClassLoader$$anon$1.read(ExecutorClassLoader.scala:107)\n\tat java.io.FilterInputStream.read(FilterInputStream.java:107)\n\tat org.apache.spark.repl.ExecutorClassLoader.readAndTransformClass(ExecutorClassLoader.scala:223)\n\tat org.apache.spark.repl.ExecutorClassLoader.findClassLocally(ExecutorClassLoader.scala:177)\n\tat org.apache.spark.repl.ExecutorClassLoader.findClass(ExecutorClassLoader.scala:81)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:411)\n\tat org.apache.spark.util.ParentClassLoader.loadClass(ParentClassLoader.scala:34)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\tat org.apache.spark.util.ParentClassLoader.loadClass(ParentClassLoader.scala:30)\n\tat java.lang.Class.forName0(Native Method)\n\tat java.lang.Class.forName(Class.java:348)\n\tat org.codehaus.janino.ClassLoaderIClassLoader.findIClass(ClassLoaderIClassLoader.java:83)\n\tat org.codehaus.janino.IClassLoader.loadIClass(IClassLoader.java:288)\n\tat org.codehaus.janino.UnitCompiler.findTypeByName(UnitCompiler.java:7611)\n\tat org.codehaus.janino.UnitCompiler.getReferenceType(UnitCompiler.java:5906)\n\tat org.codehaus.janino.UnitCompiler.getReferenceType(UnitCompiler.java:5751)\n\tat org.codehaus.janino.UnitCompiler.getType2(UnitCompiler.java:5732)\n\tat org.codehaus.janino.UnitCompiler.access$13200(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$18.visitReferenceType(UnitCompiler.java:5668)\n\tat org.codehaus.janino.UnitCompiler$18.visitReferenceType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.Java$ReferenceType.accept(Java.java:3356)\n\tat org.codehaus.janino.UnitCompiler.getType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.UnitCompiler.getType2(UnitCompiler.java:6007)\n\tat org.codehaus.janino.UnitCompiler.access$13000(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$18.visitArrayType(UnitCompiler.java:5666)\n\tat org.codehaus.janino.UnitCompiler$18.visitArrayType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.Java$ArrayType.accept(Java.java:3425)\n\tat org.codehaus.janino.UnitCompiler.getType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.UnitCompiler.access$1200(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$32.getParameterTypes2(UnitCompiler.java:9326)\n\tat org.codehaus.janino.IClass$IInvocable.getParameterTypes(IClass.java:853)\n\tat org.codehaus.janino.IClass$IMethod.getDescriptor2(IClass.java:1084)\n\tat org.codehaus.janino.IClass$IInvocable.getDescriptor(IClass.java:865)\n\tat org.codehaus.janino.IClass.getIMethods(IClass.java:211)\n\tat org.codehaus.janino.IClass.getIMethods(IClass.java:200)\n\tat org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:439)\n\tat org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:420)\n\tat org.codehaus.janino.UnitCompiler.access$400(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:374)\n\tat org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:369)\n\tat org.codehaus.janino.Java$AbstractPackageMemberClassDeclaration.accept(Java.java:1309)\n\tat org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:369)\n\tat org.codehaus.janino.UnitCompiler.compileUnit(UnitCompiler.java:345)\n\tat org.codehaus.janino.SimpleCompiler.compileToClassLoader(SimpleCompiler.java:396)\n\tat org.codehaus.janino.ClassBodyEvaluator.compileToClass(ClassBodyEvaluator.java:311)\n\tat org.codehaus.janino.ClassBodyEvaluator.cook(ClassBodyEvaluator.java:229)\n\tat org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:196)\n\tat org.codehaus.commons.compiler.Cookable.cook(Cookable.java:91)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.org$apache$spark$sql$catalyst$expressions$codegen$CodeGenerator$$doCompile(CodeGenerator.scala:1042)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1118)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1115)\n\tat com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3522)\n\tat com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2315)\n\tat com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2278)\n\tat com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2193)\n\tat com.google.common.cache.LocalCache.get(LocalCache.java:3932)\n\tat com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3936)\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4806)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.compile(CodeGenerator.scala:988)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:435)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:389)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:32)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator.generate(CodeGenerator.scala:968)\n\tat org.apache.spark.sql.catalyst.expressions.UnsafeProjection$.create(Projection.scala:130)\n\tat org.apache.spark.sql.catalyst.expressions.UnsafeProjection$.create(Projection.scala:140)\n\tat org.apache.spark.sql.execution.exchange.ShuffleExchangeExec$.org$apache$spark$sql$execution$exchange$ShuffleExchangeExec$$getPartitionKeyExtractor$1(ShuffleExchangeExec.scala:245)\n\tat org.apache.spark.sql.execution.exchange.ShuffleExchangeExec$$anonfun$3.apply(ShuffleExchangeExec.scala:258)\n\tat org.apache.spark.sql.execution.exchange.ShuffleExchangeExec$$anonfun$3.apply(ShuffleExchangeExec.scala:257)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:836)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:836)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:332)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:296)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:96)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:53)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:110)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:349)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\t... 1 more\nCaused by: java.io.IOException: Connection reset by peer\n\tat sun.nio.ch.FileDispatcherImpl.read0(Native Method)\n\tat sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)\n\tat sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)\n\tat sun.nio.ch.IOUtil.read(IOUtil.java:192)\n\tat sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)\n\tat io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:221)\n\tat io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:899)\n\tat io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:275)\n\tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:119)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:643)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:566)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:480)\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:442)\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:131)\n\tat io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:144)\n\t... 1 more\n</div>","workflows":[],"startTime":1523303855246,"submitTime":1523303855220,"finishTime":1523303860705,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"7f20230c-1ba8-4295-b710-74d328fec75c"},{"version":"CommandV1","origId":951645590912529,"guid":"84a1cc67-f272-4105-a887-8f6bcc183d84","subtype":"command","commandType":"auto","position":7.25,"command":"%md Get the list of calls where the script_url is one of the known session replay providers","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"c80853f9-b2e1-45a4-9b39-7fc6437baa80"},{"version":"CommandV1","origId":951645590912530,"guid":"13c6e9c4-04aa-4087-ae33-f497358dc6e4","subtype":"command","commandType":"auto","position":8.0,"command":"BUCKET = 'safe-ucosp-2017/safe_dataset/v1'\n\nACCESS_KEY = \"YOUR-ACCESS-KEY\"\nSECRET_KEY = \"YOUR-SERCRET-KEY\"\nENCODED_SECRET_KEY = SECRET_KEY.replace(\"/\", \"%2F\")\nAWS_BUCKET_NAME = BUCKET\n\nS3_LOCATION = \"s3a://{}:{}@{}\".format(ACCESS_KEY, ENCODED_SECRET_KEY, AWS_BUCKET_NAME)\nMOUNT = \"/mnt/{}\".format(BUCKET.replace(\"/\", \"-\"))\n\nmountPoints = lambda: np.array([m.mountPoint for m in dbutils.fs.mounts()])\nalready_mounted = np.any(mountPoints() == MOUNT)\nif not already_mounted:\n    dbutils.fs.mount(S3_LOCATION, MOUNT)\ndisplay(dbutils.fs.ls(MOUNT))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/mnt/safe-ucosp-2017-safe_dataset-v1/clean.parquet/","clean.parquet/",0],["dbfs:/mnt/safe-ucosp-2017-safe_dataset-v1/invalid.parquet/","invalid.parquet/",0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;np&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2904933995152698&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     10</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     11</span> mountPoints <span class=\"ansiyellow\">=</span> <span class=\"ansigreen\">lambda</span><span class=\"ansiyellow\">:</span> np<span class=\"ansiyellow\">.</span>array<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span>m<span class=\"ansiyellow\">.</span>mountPoint <span class=\"ansigreen\">for</span> m <span class=\"ansigreen\">in</span> dbutils<span class=\"ansiyellow\">.</span>fs<span class=\"ansiyellow\">.</span>mounts<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 12</span><span class=\"ansiyellow\"> </span>already_mounted <span class=\"ansiyellow\">=</span> np<span class=\"ansiyellow\">.</span>any<span class=\"ansiyellow\">(</span>mountPoints<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">==</span> MOUNT<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     13</span> <span class=\"ansigreen\">if</span> <span class=\"ansigreen\">not</span> already_mounted<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     14</span>     dbutils<span class=\"ansiyellow\">.</span>fs<span class=\"ansiyellow\">.</span>mount<span class=\"ansiyellow\">(</span>S3_LOCATION<span class=\"ansiyellow\">,</span> MOUNT<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;np&apos; is not defined</div>","workflows":[],"startTime":1523303863799,"submitTime":1523303863776,"finishTime":1523303866827,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5af72e4e-8d19-4b6c-8104-9a3f8900679b"},{"version":"CommandV1","origId":951645590912531,"guid":"9ae106bb-fcc3-4222-9ee1-ee0250f894ea","subtype":"command","commandType":"auto","position":8.5,"command":"df = spark.read.parquet(\"{}/{}\".format(MOUNT, 'clean.parquet'))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"argument_0","nullable":true,"type":"string"},{"metadata":{},"name":"argument_1","nullable":true,"type":"string"},{"metadata":{},"name":"argument_2","nullable":true,"type":"string"},{"metadata":{},"name":"argument_3","nullable":true,"type":"string"},{"metadata":{},"name":"argument_4","nullable":true,"type":"string"},{"metadata":{},"name":"argument_5","nullable":true,"type":"string"},{"metadata":{},"name":"argument_6","nullable":true,"type":"string"},{"metadata":{},"name":"argument_7","nullable":true,"type":"string"},{"metadata":{},"name":"argument_8","nullable":true,"type":"string"},{"metadata":{},"name":"arguments","nullable":true,"type":"string"},{"metadata":{},"name":"arguments_n_keys","nullable":true,"type":"long"},{"metadata":{},"name":"call_id","nullable":true,"type":"string"},{"metadata":{},"name":"call_stack","nullable":true,"type":"string"},{"metadata":{},"name":"crawl_id","nullable":true,"type":"long"},{"metadata":{},"name":"file_name","nullable":true,"type":"string"},{"metadata":{},"name":"func_name","nullable":true,"type":"string"},{"metadata":{},"name":"in_iframe","nullable":true,"type":"boolean"},{"metadata":{},"name":"location","nullable":true,"type":"string"},{"metadata":{},"name":"operation","nullable":true,"type":"string"},{"metadata":{},"name":"script_col","nullable":true,"type":"string"},{"metadata":{},"name":"script_line","nullable":true,"type":"string"},{"metadata":{},"name":"script_loc_eval","nullable":true,"type":"string"},{"metadata":{},"name":"script_url","nullable":true,"type":"string"},{"metadata":{},"name":"symbol","nullable":true,"type":"string"},{"metadata":{},"name":"time_stamp","nullable":true,"type":"timestamp"},{"metadata":{},"name":"value","nullable":true,"type":"string"},{"metadata":{},"name":"value_1000","nullable":true,"type":"string"},{"metadata":{},"name":"value_len","nullable":true,"type":"integer"},{"metadata":{},"name":"valid","nullable":true,"type":"boolean"},{"metadata":{},"name":"errors","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;MOUNT&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2904933995152699&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>df <span class=\"ansiyellow\">=</span> spark<span class=\"ansiyellow\">.</span>read<span class=\"ansiyellow\">.</span>parquet<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;{}/{}&quot;</span><span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>MOUNT<span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;clean.parquet&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;MOUNT&apos; is not defined</div>","workflows":[],"startTime":1523303866956,"submitTime":1523303866650,"finishTime":1523303872504,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8a803042-6eee-44ba-87fd-c8e081e39374"},{"version":"CommandV1","origId":951645590912532,"guid":"1b33792f-f7d0-48a6-986d-5a7b8b8c4602","subtype":"command","commandType":"auto","position":8.8125,"command":"from urllib.parse import urlparse\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import *","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">ImportError</span>: No module named parse","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">ImportError</span>                               Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2904933995152703&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">from</span> urllib<span class=\"ansiyellow\">.</span>parse <span class=\"ansigreen\">import</span> urlparse<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">.</span>functions <span class=\"ansigreen\">import</span> udf<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">.</span>types <span class=\"ansigreen\">import</span> <span class=\"ansiyellow\">*</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">ImportError</span>: No module named parse</div>","workflows":[],"startTime":1523303872522,"submitTime":1523303869986,"finishTime":1523303872546,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"87c6933b-9acc-40a5-a142-64d6de04c5b0"},{"version":"CommandV1","origId":951645590912533,"guid":"884d7b38-c459-4161-9e23-8e119718ccc9","subtype":"command","commandType":"auto","position":8.84375,"command":"url_string = \"|\".join(replay_sites)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;replay_sites&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-3634529858235096&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>url_string <span class=\"ansiyellow\">=</span> <span class=\"ansiblue\">&quot;|&quot;</span><span class=\"ansiyellow\">.</span>join<span class=\"ansiyellow\">(</span>replay_sites<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;replay_sites&apos; is not defined</div>","workflows":[],"startTime":1523303873368,"submitTime":1523303873345,"finishTime":1523303873383,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"de4cf941-46fc-4468-8e57-c59e805b120c"},{"version":"CommandV1","origId":951645590912534,"guid":"478acb8f-ea31-4ffa-8bf8-09d33c575884","subtype":"command","commandType":"auto","position":8.8515625,"command":"url_string","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">8</span><span class=\"ansired\">]: </span>&apos;smartlook.com|inspectlet.com|fullstory.com|luckyorange.com|quantummetric.com|userreplay.net|salemove.com|clicktale.net|hotjar.com|logrocket.com|yandex.ru|decibelinsight.net|mouseflow.com|sessioncam.com&apos;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1523303876004,"submitTime":1523303875981,"finishTime":1523303876020,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b7adb1f8-b8e3-48a1-a6bc-07d058492fd1"},{"version":"CommandV1","origId":951645590912535,"guid":"73f53743-288c-41a4-9c52-925202094e3a","subtype":"command","commandType":"auto","position":8.859375,"command":"def parse_base_url(url):\n  return urlparse(url).netloc\nudf_parse_base_url = udf(parse_base_url, StringType())","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1523303879033,"submitTime":1523303879011,"finishTime":1523303879054,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6d1fbe05-658f-43dd-a39f-2c5fb6149b44"},{"version":"CommandV1","origId":951645590912536,"guid":"ef64a2b2-ec4a-4be7-a0a9-6504427c6392","subtype":"command","commandType":"auto","position":8.9326171875,"command":"df_with_base_script_url = df.withColumn(\"base_script_url\", udf_parse_base_url(df.script_url)).withColumn(\"base_location_url\", udf_parse_base_url(df.location))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_with_base_script_url","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"argument_0","nullable":true,"type":"string"},{"metadata":{},"name":"argument_1","nullable":true,"type":"string"},{"metadata":{},"name":"argument_2","nullable":true,"type":"string"},{"metadata":{},"name":"argument_3","nullable":true,"type":"string"},{"metadata":{},"name":"argument_4","nullable":true,"type":"string"},{"metadata":{},"name":"argument_5","nullable":true,"type":"string"},{"metadata":{},"name":"argument_6","nullable":true,"type":"string"},{"metadata":{},"name":"argument_7","nullable":true,"type":"string"},{"metadata":{},"name":"argument_8","nullable":true,"type":"string"},{"metadata":{},"name":"arguments","nullable":true,"type":"string"},{"metadata":{},"name":"arguments_n_keys","nullable":true,"type":"long"},{"metadata":{},"name":"call_id","nullable":true,"type":"string"},{"metadata":{},"name":"call_stack","nullable":true,"type":"string"},{"metadata":{},"name":"crawl_id","nullable":true,"type":"long"},{"metadata":{},"name":"file_name","nullable":true,"type":"string"},{"metadata":{},"name":"func_name","nullable":true,"type":"string"},{"metadata":{},"name":"in_iframe","nullable":true,"type":"boolean"},{"metadata":{},"name":"location","nullable":true,"type":"string"},{"metadata":{},"name":"operation","nullable":true,"type":"string"},{"metadata":{},"name":"script_col","nullable":true,"type":"string"},{"metadata":{},"name":"script_line","nullable":true,"type":"string"},{"metadata":{},"name":"script_loc_eval","nullable":true,"type":"string"},{"metadata":{},"name":"script_url","nullable":true,"type":"string"},{"metadata":{},"name":"symbol","nullable":true,"type":"string"},{"metadata":{},"name":"time_stamp","nullable":true,"type":"timestamp"},{"metadata":{},"name":"value","nullable":true,"type":"string"},{"metadata":{},"name":"value_1000","nullable":true,"type":"string"},{"metadata":{},"name":"value_len","nullable":true,"type":"integer"},{"metadata":{},"name":"valid","nullable":true,"type":"boolean"},{"metadata":{},"name":"errors","nullable":true,"type":"string"},{"metadata":{},"name":"base_script_url","nullable":true,"type":"string"},{"metadata":{},"name":"base_location_url","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;udf_parse_base_url&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2904933995152701&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>df_with_base_script_url <span class=\"ansiyellow\">=</span> df<span class=\"ansiyellow\">.</span>withColumn<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;base_script_url&quot;</span><span class=\"ansiyellow\">,</span> udf_parse_base_url<span class=\"ansiyellow\">(</span>df<span class=\"ansiyellow\">.</span>script_url<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>withColumn<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;base_location_url&quot;</span><span class=\"ansiyellow\">,</span> udf_parse_base_url<span class=\"ansiyellow\">(</span>df<span class=\"ansiyellow\">.</span>location<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;udf_parse_base_url&apos; is not defined</div>","workflows":[],"startTime":1523303881502,"submitTime":1523303881478,"finishTime":1523303881630,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"afe6252f-005e-42fb-a0ac-26579c6d5375"},{"version":"CommandV1","origId":951645590912537,"guid":"d7a720f8-6212-49b6-b5c7-c4b295fbad76","subtype":"command","commandType":"auto","position":8.96484375,"command":"df.filter(df.script_url.rlike(url_string)).count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">12</span><span class=\"ansired\">]: </span>4211829\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1522940631657,"submitTime":1522940631633,"finishTime":1522941435251,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"294451c7-62c7-4bb7-a1b1-5af25edd2a6f"},{"version":"CommandV1","origId":951645590912538,"guid":"37d0d522-4e8d-46ae-a5f5-953658d329c5","subtype":"command","commandType":"auto","position":8.9677734375,"command":"sites_using_session_replay =  df_with_base_script_url.filter(df_with_base_script_url.script_url.rlike(url_string))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"sites_using_session_replay","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"argument_0","nullable":true,"type":"string"},{"metadata":{},"name":"argument_1","nullable":true,"type":"string"},{"metadata":{},"name":"argument_2","nullable":true,"type":"string"},{"metadata":{},"name":"argument_3","nullable":true,"type":"string"},{"metadata":{},"name":"argument_4","nullable":true,"type":"string"},{"metadata":{},"name":"argument_5","nullable":true,"type":"string"},{"metadata":{},"name":"argument_6","nullable":true,"type":"string"},{"metadata":{},"name":"argument_7","nullable":true,"type":"string"},{"metadata":{},"name":"argument_8","nullable":true,"type":"string"},{"metadata":{},"name":"arguments","nullable":true,"type":"string"},{"metadata":{},"name":"arguments_n_keys","nullable":true,"type":"long"},{"metadata":{},"name":"call_id","nullable":true,"type":"string"},{"metadata":{},"name":"call_stack","nullable":true,"type":"string"},{"metadata":{},"name":"crawl_id","nullable":true,"type":"long"},{"metadata":{},"name":"file_name","nullable":true,"type":"string"},{"metadata":{},"name":"func_name","nullable":true,"type":"string"},{"metadata":{},"name":"in_iframe","nullable":true,"type":"boolean"},{"metadata":{},"name":"location","nullable":true,"type":"string"},{"metadata":{},"name":"operation","nullable":true,"type":"string"},{"metadata":{},"name":"script_col","nullable":true,"type":"string"},{"metadata":{},"name":"script_line","nullable":true,"type":"string"},{"metadata":{},"name":"script_loc_eval","nullable":true,"type":"string"},{"metadata":{},"name":"script_url","nullable":true,"type":"string"},{"metadata":{},"name":"symbol","nullable":true,"type":"string"},{"metadata":{},"name":"time_stamp","nullable":true,"type":"timestamp"},{"metadata":{},"name":"value","nullable":true,"type":"string"},{"metadata":{},"name":"value_1000","nullable":true,"type":"string"},{"metadata":{},"name":"value_len","nullable":true,"type":"integer"},{"metadata":{},"name":"valid","nullable":true,"type":"boolean"},{"metadata":{},"name":"errors","nullable":true,"type":"string"},{"metadata":{},"name":"base_script_url","nullable":true,"type":"string"},{"metadata":{},"name":"base_location_url","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;df_with_base_script_url&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-3634529858235178&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>sites_using_session_replay <span class=\"ansiyellow\">=</span>  df_with_base_script_url<span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span>df_with_base_script_url<span class=\"ansiyellow\">.</span>script_url<span class=\"ansiyellow\">.</span>rlike<span class=\"ansiyellow\">(</span>url_string<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;df_with_base_script_url&apos; is not defined</div>","workflows":[],"startTime":1523303888440,"submitTime":1523303888417,"finishTime":1523303888842,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"55e7219c-a487-4d98-99f5-ed78a7345e42"},{"version":"CommandV1","origId":951645590912539,"guid":"44924551-34de-42c2-82dc-2afad35d687d","subtype":"command","commandType":"auto","position":8.968505859375,"command":"sites_using_session_replay.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">13</span><span class=\"ansired\">]: </span>4211829\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1523236094820,"submitTime":1523236094793,"finishTime":1523236896100,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6266fbaf-3f07-4e65-a393-b5baa4a18e0e"},{"version":"CommandV1","origId":951645590912540,"guid":"dc976151-2d62-4a8d-9493-ba9675cdfb04","subtype":"command","commandType":"auto","position":8.96923828125,"command":"df_with_base_script_url.dropDuplicates(['base_location_url']).count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">14</span><span class=\"ansired\">]: </span>87325\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"The spark context has been stopped or the cluster has been terminated. Please restart the cluster or attach this notebook to a different cluster.","error":null,"workflows":[],"startTime":1522893120471,"submitTime":1522893120454,"finishTime":1522894178529,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bab1b71c-7aa9-49bf-a6dc-a3596ea74c64"},{"version":"CommandV1","origId":951645590912541,"guid":"5bf07307-c8d8-4337-a79b-4e577d158a8b","subtype":"command","commandType":"auto","position":8.970703125,"command":"def parse_url_scheme(url):\n  return urlparse(url).scheme\nudf_parse_url_scheme = udf(parse_url_scheme, StringType())","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1522944586245,"submitTime":1522944586222,"finishTime":1522944586263,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3bb33b1e-4dc5-4919-8a49-f9c24943a2f0"},{"version":"CommandV1","origId":951645590912542,"guid":"5a62587d-43a7-4251-84a3-cd18c05978f1","subtype":"command","commandType":"auto","position":8.97509765625,"command":"df_with_scheme = df.withColumn(\"script_scheme\", udf_parse_url_scheme(df.script_url)).withColumn(\"location_scheme\", udf_parse_url_scheme(df.location))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_with_scheme","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"argument_0","nullable":true,"type":"string"},{"metadata":{},"name":"argument_1","nullable":true,"type":"string"},{"metadata":{},"name":"argument_2","nullable":true,"type":"string"},{"metadata":{},"name":"argument_3","nullable":true,"type":"string"},{"metadata":{},"name":"argument_4","nullable":true,"type":"string"},{"metadata":{},"name":"argument_5","nullable":true,"type":"string"},{"metadata":{},"name":"argument_6","nullable":true,"type":"string"},{"metadata":{},"name":"argument_7","nullable":true,"type":"string"},{"metadata":{},"name":"argument_8","nullable":true,"type":"string"},{"metadata":{},"name":"arguments","nullable":true,"type":"string"},{"metadata":{},"name":"arguments_n_keys","nullable":true,"type":"long"},{"metadata":{},"name":"call_id","nullable":true,"type":"string"},{"metadata":{},"name":"call_stack","nullable":true,"type":"string"},{"metadata":{},"name":"crawl_id","nullable":true,"type":"long"},{"metadata":{},"name":"file_name","nullable":true,"type":"string"},{"metadata":{},"name":"func_name","nullable":true,"type":"string"},{"metadata":{},"name":"in_iframe","nullable":true,"type":"boolean"},{"metadata":{},"name":"location","nullable":true,"type":"string"},{"metadata":{},"name":"operation","nullable":true,"type":"string"},{"metadata":{},"name":"script_col","nullable":true,"type":"string"},{"metadata":{},"name":"script_line","nullable":true,"type":"string"},{"metadata":{},"name":"script_loc_eval","nullable":true,"type":"string"},{"metadata":{},"name":"script_url","nullable":true,"type":"string"},{"metadata":{},"name":"symbol","nullable":true,"type":"string"},{"metadata":{},"name":"time_stamp","nullable":true,"type":"timestamp"},{"metadata":{},"name":"value","nullable":true,"type":"string"},{"metadata":{},"name":"value_1000","nullable":true,"type":"string"},{"metadata":{},"name":"value_len","nullable":true,"type":"integer"},{"metadata":{},"name":"valid","nullable":true,"type":"boolean"},{"metadata":{},"name":"errors","nullable":true,"type":"string"},{"metadata":{},"name":"script_scheme","nullable":true,"type":"string"},{"metadata":{},"name":"location_scheme","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1522944590874,"submitTime":1522944590851,"finishTime":1522944590953,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b3de5c88-4d1f-498e-ac7e-d4125a7e9f61"},{"version":"CommandV1","origId":951645590912543,"guid":"448a3802-0b2c-4782-b0ee-89f14fc73fec","subtype":"command","commandType":"auto","position":8.9776611328125,"command":"df_with_scheme.groupBy(\"script_scheme\", \"location_scheme\").count().collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">20</span><span class=\"ansired\">]: </span>\n[Row(script_scheme=&apos;&apos;, location_scheme=&apos;https&apos;, count=96065),\n Row(script_scheme=&apos;https&apos;, location_scheme=&apos;http&apos;, count=8382482),\n Row(script_scheme=&apos;webpack-internal&apos;, location_scheme=&apos;http&apos;, count=6),\n Row(script_scheme=&apos;resource&apos;, location_scheme=&apos;https&apos;, count=114417),\n Row(script_scheme=&apos;blob&apos;, location_scheme=&apos;http&apos;, count=432),\n Row(script_scheme=&apos;&apos;, location_scheme=&apos;http&apos;, count=22123),\n Row(script_scheme=&apos;https&apos;, location_scheme=&apos;https&apos;, count=71980786),\n Row(script_scheme=&apos;webpack&apos;, location_scheme=&apos;http&apos;, count=7448),\n Row(script_scheme=&apos;file&apos;, location_scheme=&apos;https&apos;, count=519),\n Row(script_scheme=&apos;webpack&apos;, location_scheme=&apos;https&apos;, count=29500),\n Row(script_scheme=&apos;script&apos;, location_scheme=&apos;http&apos;, count=6),\n Row(script_scheme=&apos;blob&apos;, location_scheme=&apos;https&apos;, count=1967),\n Row(script_scheme=&apos;script&apos;, location_scheme=&apos;https&apos;, count=787),\n Row(script_scheme=&apos;webpack-internal&apos;, location_scheme=&apos;https&apos;, count=15),\n Row(script_scheme=&apos;resource&apos;, location_scheme=&apos;http&apos;, count=251278),\n Row(script_scheme=&apos;data&apos;, location_scheme=&apos;https&apos;, count=875),\n Row(script_scheme=&apos;data&apos;, location_scheme=&apos;http&apos;, count=142),\n Row(script_scheme=&apos;http&apos;, location_scheme=&apos;https&apos;, count=1),\n Row(script_scheme=&apos;http&apos;, location_scheme=&apos;http&apos;, count=32825160)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1522946448867,"submitTime":1522946448842,"finishTime":1522947705585,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"96c2ecd9-443d-4061-875a-ea47843fa41d"},{"version":"CommandV1","origId":951645590912544,"guid":"b712ab01-b3a2-44f3-a486-a0895a21ab38","subtype":"command","commandType":"auto","position":8.980224609375,"command":"session_replay_scheme =  df_with_scheme.filter(df_with_scheme.script_url.rlike(url_string))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"session_replay_scheme","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"argument_0","nullable":true,"type":"string"},{"metadata":{},"name":"argument_1","nullable":true,"type":"string"},{"metadata":{},"name":"argument_2","nullable":true,"type":"string"},{"metadata":{},"name":"argument_3","nullable":true,"type":"string"},{"metadata":{},"name":"argument_4","nullable":true,"type":"string"},{"metadata":{},"name":"argument_5","nullable":true,"type":"string"},{"metadata":{},"name":"argument_6","nullable":true,"type":"string"},{"metadata":{},"name":"argument_7","nullable":true,"type":"string"},{"metadata":{},"name":"argument_8","nullable":true,"type":"string"},{"metadata":{},"name":"arguments","nullable":true,"type":"string"},{"metadata":{},"name":"arguments_n_keys","nullable":true,"type":"long"},{"metadata":{},"name":"call_id","nullable":true,"type":"string"},{"metadata":{},"name":"call_stack","nullable":true,"type":"string"},{"metadata":{},"name":"crawl_id","nullable":true,"type":"long"},{"metadata":{},"name":"file_name","nullable":true,"type":"string"},{"metadata":{},"name":"func_name","nullable":true,"type":"string"},{"metadata":{},"name":"in_iframe","nullable":true,"type":"boolean"},{"metadata":{},"name":"location","nullable":true,"type":"string"},{"metadata":{},"name":"operation","nullable":true,"type":"string"},{"metadata":{},"name":"script_col","nullable":true,"type":"string"},{"metadata":{},"name":"script_line","nullable":true,"type":"string"},{"metadata":{},"name":"script_loc_eval","nullable":true,"type":"string"},{"metadata":{},"name":"script_url","nullable":true,"type":"string"},{"metadata":{},"name":"symbol","nullable":true,"type":"string"},{"metadata":{},"name":"time_stamp","nullable":true,"type":"timestamp"},{"metadata":{},"name":"value","nullable":true,"type":"string"},{"metadata":{},"name":"value_1000","nullable":true,"type":"string"},{"metadata":{},"name":"value_len","nullable":true,"type":"integer"},{"metadata":{},"name":"valid","nullable":true,"type":"boolean"},{"metadata":{},"name":"errors","nullable":true,"type":"string"},{"metadata":{},"name":"script_scheme","nullable":true,"type":"string"},{"metadata":{},"name":"location_scheme","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1522944594215,"submitTime":1522944594192,"finishTime":1522944594249,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8c122a03-44df-490b-8de3-951f0759a701"},{"version":"CommandV1","origId":951645590912545,"guid":"b8b334f9-eea9-49a4-a376-62cc29291b23","subtype":"command","commandType":"auto","position":8.9827880859375,"command":"session_replay_scheme.groupBy(\"script_scheme\", \"location_scheme\").count().collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">16</span><span class=\"ansired\">]: </span>\n[Row(script_scheme=&apos;https&apos;, location_scheme=&apos;http&apos;, count=942662),\n Row(script_scheme=&apos;https&apos;, location_scheme=&apos;https&apos;, count=2110433),\n Row(script_scheme=&apos;http&apos;, location_scheme=&apos;http&apos;, count=1158734)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 5 in stage 27.0 failed 1 times, most recent failure: Lost task 5.0 in stage 27.0 (TID 2511, localhost, executor driver): org.apache.spark.repl.RemoteClassLoaderError: org/apache/spark/sql/catalyst/expressions/Object.class","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-4167030868715850&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>session_replay_scheme<span class=\"ansiyellow\">.</span>groupBy<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;script_scheme&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;location_scheme&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>count<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>collect<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">collect</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">    452</span>         <span class=\"ansired\"># Default path used in OSS Spark / for non-DF-ACL clusters:</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    453</span>         <span class=\"ansigreen\">with</span> SCCallSiteSync<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_sc<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">as</span> css<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 454</span><span class=\"ansiyellow\">             </span>port <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>collectToPython<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    455</span>         <span class=\"ansigreen\">return</span> list<span class=\"ansiyellow\">(</span>_load_from_socket<span class=\"ansiyellow\">(</span>port<span class=\"ansiyellow\">,</span> BatchedSerializer<span class=\"ansiyellow\">(</span>PickleSerializer<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    456</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    317</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    318</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 319</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o703.collectToPython.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 5 in stage 27.0 failed 1 times, most recent failure: Lost task 5.0 in stage 27.0 (TID 2511, localhost, executor driver): org.apache.spark.repl.RemoteClassLoaderError: org/apache/spark/sql/catalyst/expressions/Object.class\n\tat org.apache.spark.repl.ExecutorClassLoader$$anon$1.toClassNotFound(ExecutorClassLoader.scala:119)\n\tat org.apache.spark.repl.ExecutorClassLoader$$anon$1.read(ExecutorClassLoader.scala:107)\n\tat java.io.FilterInputStream.read(FilterInputStream.java:107)\n\tat org.apache.spark.repl.ExecutorClassLoader.readAndTransformClass(ExecutorClassLoader.scala:223)\n\tat org.apache.spark.repl.ExecutorClassLoader.findClassLocally(ExecutorClassLoader.scala:177)\n\tat org.apache.spark.repl.ExecutorClassLoader.findClass(ExecutorClassLoader.scala:81)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:411)\n\tat org.apache.spark.util.ParentClassLoader.loadClass(ParentClassLoader.scala:34)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\tat org.apache.spark.util.ParentClassLoader.loadClass(ParentClassLoader.scala:30)\n\tat java.lang.Class.forName0(Native Method)\n\tat java.lang.Class.forName(Class.java:348)\n\tat org.codehaus.janino.ClassLoaderIClassLoader.findIClass(ClassLoaderIClassLoader.java:83)\n\tat org.codehaus.janino.IClassLoader.loadIClass(IClassLoader.java:288)\n\tat org.codehaus.janino.UnitCompiler.findTypeByName(UnitCompiler.java:7611)\n\tat org.codehaus.janino.UnitCompiler.getReferenceType(UnitCompiler.java:5906)\n\tat org.codehaus.janino.UnitCompiler.getReferenceType(UnitCompiler.java:5751)\n\tat org.codehaus.janino.UnitCompiler.getType2(UnitCompiler.java:5732)\n\tat org.codehaus.janino.UnitCompiler.access$13200(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$18.visitReferenceType(UnitCompiler.java:5668)\n\tat org.codehaus.janino.UnitCompiler$18.visitReferenceType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.Java$ReferenceType.accept(Java.java:3356)\n\tat org.codehaus.janino.UnitCompiler.getType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.UnitCompiler.getType2(UnitCompiler.java:6007)\n\tat org.codehaus.janino.UnitCompiler.access$13000(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$18.visitArrayType(UnitCompiler.java:5666)\n\tat org.codehaus.janino.UnitCompiler$18.visitArrayType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.Java$ArrayType.accept(Java.java:3425)\n\tat org.codehaus.janino.UnitCompiler.getType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.UnitCompiler.access$1200(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$32.getParameterTypes2(UnitCompiler.java:9326)\n\tat org.codehaus.janino.IClass$IInvocable.getParameterTypes(IClass.java:853)\n\tat org.codehaus.janino.IClass$IMethod.getDescriptor2(IClass.java:1084)\n\tat org.codehaus.janino.IClass$IInvocable.getDescriptor(IClass.java:865)\n\tat org.codehaus.janino.IClass.getIMethods(IClass.java:211)\n\tat org.codehaus.janino.IClass.getIMethods(IClass.java:200)\n\tat org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:439)\n\tat org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:420)\n\tat org.codehaus.janino.UnitCompiler.access$400(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:374)\n\tat org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:369)\n\tat org.codehaus.janino.Java$AbstractPackageMemberClassDeclaration.accept(Java.java:1309)\n\tat org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:369)\n\tat org.codehaus.janino.UnitCompiler.compileUnit(UnitCompiler.java:345)\n\tat org.codehaus.janino.SimpleCompiler.compileToClassLoader(SimpleCompiler.java:396)\n\tat org.codehaus.janino.ClassBodyEvaluator.compileToClass(ClassBodyEvaluator.java:311)\n\tat org.codehaus.janino.ClassBodyEvaluator.cook(ClassBodyEvaluator.java:229)\n\tat org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:196)\n\tat org.codehaus.commons.compiler.Cookable.cook(Cookable.java:91)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.org$apache$spark$sql$catalyst$expressions$codegen$CodeGenerator$$doCompile(CodeGenerator.scala:1042)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1118)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1115)\n\tat com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3522)\n\tat com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2315)\n\tat com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2278)\n\tat com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2193)\n\tat com.google.common.cache.LocalCache.get(LocalCache.java:3932)\n\tat com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3936)\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4806)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.compile(CodeGenerator.scala:988)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:435)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:389)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:32)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator.generate(CodeGenerator.scala:968)\n\tat org.apache.spark.sql.catalyst.expressions.UnsafeProjection$.create(Projection.scala:130)\n\tat org.apache.spark.sql.execution.aggregate.HashAggregateExec.getEmptyAggregationBuffer(HashAggregateExec.scala:386)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.wholestagecodegen_init_0$(Unknown Source)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.init(Unknown Source)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$8.apply(WholeStageCodegenExec.scala:420)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$8.apply(WholeStageCodegenExec.scala:417)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsWithIndex$1$$anonfun$apply$26.apply(RDD.scala:853)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsWithIndex$1$$anonfun$apply$26.apply(RDD.scala:853)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:332)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:296)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:332)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:296)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:96)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:53)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:110)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:349)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: java.io.IOException: Connection reset by peer\n\tat sun.nio.ch.FileDispatcherImpl.read0(Native Method)\n\tat sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)\n\tat sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)\n\tat sun.nio.ch.IOUtil.read(IOUtil.java:192)\n\tat sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)\n\tat io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:221)\n\tat io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:899)\n\tat io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:275)\n\tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:119)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:643)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:566)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:480)\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:442)\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:131)\n\tat io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:144)\n\t... 1 more\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1683)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1671)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1670)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1670)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:931)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:931)\n\tat scala.Option.foreach(Option.scala:257)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:931)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1903)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1854)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1842)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:733)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2114)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2211)\n\tat org.apache.spark.sql.execution.collect.Collector.runSparkJobs(Collector.scala:206)\n\tat org.apache.spark.sql.execution.collect.Collector.collect(Collector.scala:241)\n\tat org.apache.spark.sql.execution.collect.Collector$.collect(Collector.scala:64)\n\tat org.apache.spark.sql.execution.collect.Collector$.collect(Collector.scala:70)\n\tat org.apache.spark.sql.execution.SparkPlan.executeCollectResult(SparkPlan.scala:264)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply$mcI$sp(Dataset.scala:2938)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply(Dataset.scala:2936)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply(Dataset.scala:2936)\n\tat org.apache.spark.sql.execution.SQLExecution$.withCustomExecutionEnv(SQLExecution.scala:89)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:127)\n\tat org.apache.spark.sql.Dataset.withNewExecutionId(Dataset.scala:3007)\n\tat org.apache.spark.sql.Dataset.collectToPython(Dataset.scala:2936)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:380)\n\tat py4j.Gateway.invoke(Gateway.java:293)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:226)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: org.apache.spark.repl.RemoteClassLoaderError: org/apache/spark/sql/catalyst/expressions/Object.class\n\tat org.apache.spark.repl.ExecutorClassLoader$$anon$1.toClassNotFound(ExecutorClassLoader.scala:119)\n\tat org.apache.spark.repl.ExecutorClassLoader$$anon$1.read(ExecutorClassLoader.scala:107)\n\tat java.io.FilterInputStream.read(FilterInputStream.java:107)\n\tat org.apache.spark.repl.ExecutorClassLoader.readAndTransformClass(ExecutorClassLoader.scala:223)\n\tat org.apache.spark.repl.ExecutorClassLoader.findClassLocally(ExecutorClassLoader.scala:177)\n\tat org.apache.spark.repl.ExecutorClassLoader.findClass(ExecutorClassLoader.scala:81)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:411)\n\tat org.apache.spark.util.ParentClassLoader.loadClass(ParentClassLoader.scala:34)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\tat org.apache.spark.util.ParentClassLoader.loadClass(ParentClassLoader.scala:30)\n\tat java.lang.Class.forName0(Native Method)\n\tat java.lang.Class.forName(Class.java:348)\n\tat org.codehaus.janino.ClassLoaderIClassLoader.findIClass(ClassLoaderIClassLoader.java:83)\n\tat org.codehaus.janino.IClassLoader.loadIClass(IClassLoader.java:288)\n\tat org.codehaus.janino.UnitCompiler.findTypeByName(UnitCompiler.java:7611)\n\tat org.codehaus.janino.UnitCompiler.getReferenceType(UnitCompiler.java:5906)\n\tat org.codehaus.janino.UnitCompiler.getReferenceType(UnitCompiler.java:5751)\n\tat org.codehaus.janino.UnitCompiler.getType2(UnitCompiler.java:5732)\n\tat org.codehaus.janino.UnitCompiler.access$13200(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$18.visitReferenceType(UnitCompiler.java:5668)\n\tat org.codehaus.janino.UnitCompiler$18.visitReferenceType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.Java$ReferenceType.accept(Java.java:3356)\n\tat org.codehaus.janino.UnitCompiler.getType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.UnitCompiler.getType2(UnitCompiler.java:6007)\n\tat org.codehaus.janino.UnitCompiler.access$13000(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$18.visitArrayType(UnitCompiler.java:5666)\n\tat org.codehaus.janino.UnitCompiler$18.visitArrayType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.Java$ArrayType.accept(Java.java:3425)\n\tat org.codehaus.janino.UnitCompiler.getType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.UnitCompiler.access$1200(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$32.getParameterTypes2(UnitCompiler.java:9326)\n\tat org.codehaus.janino.IClass$IInvocable.getParameterTypes(IClass.java:853)\n\tat org.codehaus.janino.IClass$IMethod.getDescriptor2(IClass.java:1084)\n\tat org.codehaus.janino.IClass$IInvocable.getDescriptor(IClass.java:865)\n\tat org.codehaus.janino.IClass.getIMethods(IClass.java:211)\n\tat org.codehaus.janino.IClass.getIMethods(IClass.java:200)\n\tat org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:439)\n\tat org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:420)\n\tat org.codehaus.janino.UnitCompiler.access$400(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:374)\n\tat org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:369)\n\tat org.codehaus.janino.Java$AbstractPackageMemberClassDeclaration.accept(Java.java:1309)\n\tat org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:369)\n\tat org.codehaus.janino.UnitCompiler.compileUnit(UnitCompiler.java:345)\n\tat org.codehaus.janino.SimpleCompiler.compileToClassLoader(SimpleCompiler.java:396)\n\tat org.codehaus.janino.ClassBodyEvaluator.compileToClass(ClassBodyEvaluator.java:311)\n\tat org.codehaus.janino.ClassBodyEvaluator.cook(ClassBodyEvaluator.java:229)\n\tat org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:196)\n\tat org.codehaus.commons.compiler.Cookable.cook(Cookable.java:91)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.org$apache$spark$sql$catalyst$expressions$codegen$CodeGenerator$$doCompile(CodeGenerator.scala:1042)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1118)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1115)\n\tat com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3522)\n\tat com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2315)\n\tat com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2278)\n\tat com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2193)\n\tat com.google.common.cache.LocalCache.get(LocalCache.java:3932)\n\tat com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3936)\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4806)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.compile(CodeGenerator.scala:988)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:435)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:389)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:32)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator.generate(CodeGenerator.scala:968)\n\tat org.apache.spark.sql.catalyst.expressions.UnsafeProjection$.create(Projection.scala:130)\n\tat org.apache.spark.sql.execution.aggregate.HashAggregateExec.getEmptyAggregationBuffer(HashAggregateExec.scala:386)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.wholestagecodegen_init_0$(Unknown Source)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.init(Unknown Source)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$8.apply(WholeStageCodegenExec.scala:420)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$8.apply(WholeStageCodegenExec.scala:417)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsWithIndex$1$$anonfun$apply$26.apply(RDD.scala:853)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsWithIndex$1$$anonfun$apply$26.apply(RDD.scala:853)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:332)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:296)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:332)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:296)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:96)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:53)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:110)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:349)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\t... 1 more\nCaused by: java.io.IOException: Connection reset by peer\n\tat sun.nio.ch.FileDispatcherImpl.read0(Native Method)\n\tat sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)\n\tat sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)\n\tat sun.nio.ch.IOUtil.read(IOUtil.java:192)\n\tat sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)\n\tat io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:221)\n\tat io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:899)\n\tat io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:275)\n\tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:119)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:643)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:566)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:480)\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:442)\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:131)\n\tat io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:144)\n\t... 1 more\n</div>","workflows":[],"startTime":1522872140272,"submitTime":1522872140231,"finishTime":1522873397455,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3ef8cd28-6852-4c51-81ea-873ded215c21"},{"version":"CommandV1","origId":951645590912546,"guid":"d47dd410-eb87-4a42-bb75-97ad3e6d0d5e","subtype":"command","commandType":"auto","position":8.983428955078125,"command":"def parse_suffix(url):\n  return url.split(\".\")[-1]\nudf_parse_suffix = udf(parse_suffix, StringType())","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1523303938430,"submitTime":1523303938407,"finishTime":1523303938450,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7fa888ee-899a-4dc0-95a7-6ad81622c500"},{"version":"CommandV1","origId":951645590912547,"guid":"bcd58ee0-10f6-46a7-ad88-68748fd23356","subtype":"command","commandType":"auto","position":8.98406982421875,"command":"df_suffix = df_with_base_script_url.withColumn(\"location_suffix\", udf_parse_suffix(df_with_base_script_url.base_location_url))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_suffix","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"argument_0","nullable":true,"type":"string"},{"metadata":{},"name":"argument_1","nullable":true,"type":"string"},{"metadata":{},"name":"argument_2","nullable":true,"type":"string"},{"metadata":{},"name":"argument_3","nullable":true,"type":"string"},{"metadata":{},"name":"argument_4","nullable":true,"type":"string"},{"metadata":{},"name":"argument_5","nullable":true,"type":"string"},{"metadata":{},"name":"argument_6","nullable":true,"type":"string"},{"metadata":{},"name":"argument_7","nullable":true,"type":"string"},{"metadata":{},"name":"argument_8","nullable":true,"type":"string"},{"metadata":{},"name":"arguments","nullable":true,"type":"string"},{"metadata":{},"name":"arguments_n_keys","nullable":true,"type":"long"},{"metadata":{},"name":"call_id","nullable":true,"type":"string"},{"metadata":{},"name":"call_stack","nullable":true,"type":"string"},{"metadata":{},"name":"crawl_id","nullable":true,"type":"long"},{"metadata":{},"name":"file_name","nullable":true,"type":"string"},{"metadata":{},"name":"func_name","nullable":true,"type":"string"},{"metadata":{},"name":"in_iframe","nullable":true,"type":"boolean"},{"metadata":{},"name":"location","nullable":true,"type":"string"},{"metadata":{},"name":"operation","nullable":true,"type":"string"},{"metadata":{},"name":"script_col","nullable":true,"type":"string"},{"metadata":{},"name":"script_line","nullable":true,"type":"string"},{"metadata":{},"name":"script_loc_eval","nullable":true,"type":"string"},{"metadata":{},"name":"script_url","nullable":true,"type":"string"},{"metadata":{},"name":"symbol","nullable":true,"type":"string"},{"metadata":{},"name":"time_stamp","nullable":true,"type":"timestamp"},{"metadata":{},"name":"value","nullable":true,"type":"string"},{"metadata":{},"name":"value_1000","nullable":true,"type":"string"},{"metadata":{},"name":"value_len","nullable":true,"type":"integer"},{"metadata":{},"name":"valid","nullable":true,"type":"boolean"},{"metadata":{},"name":"errors","nullable":true,"type":"string"},{"metadata":{},"name":"base_script_url","nullable":true,"type":"string"},{"metadata":{},"name":"base_location_url","nullable":true,"type":"string"},{"metadata":{},"name":"location_suffix","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;DataFrame&apos; object has no attribute &apos;location_scheme&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-4167030868715852&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>df_with_base_script_url<span class=\"ansiyellow\">.</span>withColumn<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;location_suffix&quot;</span><span class=\"ansiyellow\">,</span> udf_parse_suffix<span class=\"ansiyellow\">(</span>df_with_base_script_url<span class=\"ansiyellow\">.</span>location_scheme<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">__getattr__</span><span class=\"ansiblue\">(self, name)</span>\n<span class=\"ansigreen\">   1039</span>         <span class=\"ansigreen\">if</span> name <span class=\"ansigreen\">not</span> <span class=\"ansigreen\">in</span> self<span class=\"ansiyellow\">.</span>columns<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1040</span>             raise AttributeError(\n<span class=\"ansigreen\">-&gt; 1041</span><span class=\"ansiyellow\">                 &quot;&apos;%s&apos; object has no attribute &apos;%s&apos;&quot; % (self.__class__.__name__, name))\n</span><span class=\"ansigreen\">   1042</span>         jc <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>apply<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1043</span>         <span class=\"ansigreen\">return</span> Column<span class=\"ansiyellow\">(</span>jc<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;DataFrame&apos; object has no attribute &apos;location_scheme&apos;</div>","workflows":[],"startTime":1523303941574,"submitTime":1523303941551,"finishTime":1523303941643,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cf9b40fb-3895-4e1c-8e47-bb18cc57b869"},{"version":"CommandV1","origId":951645590912548,"guid":"e1dd2c3f-6117-4cfb-aff5-800b4dd418dd","subtype":"command","commandType":"auto","position":8.984596252441406,"command":"suffixes_session_replay = df_suffix.filter(df_suffix.script_url.rlike(url_string)).groupBy(\"location_suffix\").count().collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1523239758611,"submitTime":1523239758585,"finishTime":1523241002254,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f70137c6-b293-4f74-9691-6d4559770d55"},{"version":"CommandV1","origId":951645590912549,"guid":"42eb4a18-43a5-43e8-aa94-0dbf20d6b4d2","subtype":"command","commandType":"auto","position":8.98472785949707,"command":"suffixes_session_replay_unique = df_suffix.filter(df_suffix.script_url.rlike(url_string)).dropDuplicates(['base_location_url']).groupBy(\"location_suffix\").count().collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1523304028859,"submitTime":1523304028835,"finishTime":1523305272528,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7bd3d688-38b1-4f44-a171-c05f75f6785c"},{"version":"CommandV1","origId":951645590912550,"guid":"3c7e6282-21be-4ba4-bc41-7db6cc6d8b05","subtype":"command","commandType":"auto","position":8.984760761260986,"command":"suffixes_unique = df_suffix.dropDuplicates(['base_location_url']).groupBy(\"location_suffix\").count().collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1523305397364,"submitTime":1523305397342,"finishTime":1523306282176,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"afbf8ade-2964-418d-a293-5e40f4ee21d2"},{"version":"CommandV1","origId":951645590912551,"guid":"27c789fe-268e-49e9-b2ad-5f87235538f9","subtype":"command","commandType":"auto","position":8.984777212142944,"command":"suffixes_unique.sort(key = lambda x: x[1], reverse = True)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1523306299677,"submitTime":1523306299656,"finishTime":1523306299696,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"27c157f2-0040-46af-9e3e-91f5f86e005c"},{"version":"CommandV1","origId":951645590912552,"guid":"daeb138a-b679-40a7-a3ef-4f6d94b918f3","subtype":"command","commandType":"auto","position":8.984793663024902,"command":"suffixes_session_replay_unique.sort(key = lambda x: x[1], reverse = True)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1523305328933,"submitTime":1523305328926,"finishTime":1523305328953,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9a7032f2-8be6-475e-a309-15dc7bc2a037"},{"version":"CommandV1","origId":951645590912553,"guid":"ff7fc956-d7b8-4fbe-8312-2f99e8048e36","subtype":"command","commandType":"auto","position":8.984859466552734,"command":"suffixes_session_replay.sort(key = lambda x: x[1], reverse = True)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1523241029212,"submitTime":1523241029183,"finishTime":1523241029306,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b9daa4c2-c328-4767-a4ed-4560217baa43"},{"version":"CommandV1","origId":951645590912554,"guid":"1761219c-1652-48bb-af8d-4248442a827b","subtype":"command","commandType":"auto","position":8.984991073608398,"command":"display(suffixes_session_replay)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["ru",1940300],["com",1393716],["net",163113],["tv",69565],["kz",47348],["org",42674],["me",37163],["tr",32824],["au",31905],["de",28275],["ua",25547],["eu",24489],["top",21568],["cc",20885],["edu",19908],["es",18454],["to",18421],["br",17146],["vn",17021],["it",16808],["by",15432],["jp",13287],["fm",12668],["co",12329],["uz",11661],["az",9958],["in",9593],["gr",9526],["club",9298],["biz",8982],["io",7835],["uk",6540],["su",6136],["ca",5915],["be",5860],["cz",5596],["gov",5158],["mobi",4979],["ir",4213],["fr",4076],["pl",4002],["sk",3212],["cat",2962],["hu",2870],["il",2730],["se",2653],["@D",2642],["money",2524],["name",2465],["kr",2297],["tw",1886],["hr",1713],["no",1703],["ag",1626],["my",1360],["pt",1310],["pro",1188],["ws",986],["bg",823],["mx",736],["za",684],["news",667],["adult",656],["ke",645],["ar",644],["fi",636],["dk",567],["info",510],["cn",501],["id",491],["asia",479],["nl",355],["ie",352],["st",332],["at",323],["space",303],["mu",287],["download",283],["us",264],["ch",258],["sg",254],["lv",227],["bz",198],["ro",189],["lt",182],["nz",172],["agency",171],["win",171],["re",150],["ao",148],["guru",140],["hk",139],["nu",139],["digital",132],["ec",122],["ph",120],["travel",116],["pk",104],["cash",104],["aero",104],["site",103],["ee",101],["fo",100],["sex",99],["lu",98],["ae",94],["xxx",89],["pw",87],["",81],["pe",71],["cl",66],["ng",64],["media",57],["market",57],["realtor",50],["do",49],["lb",49],["ni",45],["is",45],["gg",45],["ma",35],["rs",26],["expert",17],["education",16],["kh",16],["kg",16],["dhl",15],["host",14],["sx",12],["moscow",11],["=0H5-",8],["xyz",4],["company",4],["international",4],["uy",1],["ve",1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"location_suffix","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1523241984116,"submitTime":1523241984090,"finishTime":1523241984433,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"58435706-19ed-4602-a699-b7555ee1b5ad"},{"version":"CommandV1","origId":951645590912555,"guid":"37c5f723-9558-4d65-90ee-c60ea58c3979","subtype":"command","commandType":"auto","position":8.98505687713623,"command":"display(suffixes_session_replay_unique)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["com",1739],["ru",1634],["net",101],["edu",96],["org",66],["tv",65],["ua",64],["kz",63],["tr",54],["br",54],["uk",51],["by",48],["it",45],["sk",44],["de",37],["es",32],["pl",31],["au",31],["il",30],["az",28],["ca",27],["fr",27],["me",24],["hu",23],["gr",19],["cz",19],["jp",16],["in",15],["@D",15],["be",14],["se",13],["cat",12],["pro",12],["io",10],["co",9],["cc",8],["gov",8],["eu",8],["nl",8],["tw",7],["hr",7],["su",7],["ar",7],["ch",7],["no",7],["club",7],["fm",6],["mu",6],["ie",6],["dk",6],["biz",6],["to",6],["uz",5],["cn",5],["pt",5],["sg",5],["my",5],["nz",5],["bg",5],["at",5],["info",5],["fi",5],["mx",4],["id",4],["travel",3],["cl",3],["ro",3],["lv",3],["vn",3],["za",3],["news",3],["ir",3],["top",3],["hk",3],["kr",3],["pe",3],["ee",3],["ws",3],["us",2],["name",2],["ao",2],["re",2],["agency",2],["money",2],["ae",2],["pw",2],["lu",2],["xxx",2],["media",2],["ng",2],["lt",2],["kg",2],["asia",2],["space",1],["dhl",1],["ag",1],["=0H5-",1],["st",1],["expert",1],["education",1],["sx",1],["ke",1],["kh",1],["ni",1],["pk",1],["moscow",1],["bz",1],["cash",1],["ec",1],["guru",1],["download",1],["is",1],["xyz",1],["realtor",1],["adult",1],["mobi",1],["rs",1],["site",1],["uy",1],["nu",1],["ph",1],["host",1],["digital",1],["ve",1],["win",1],["market",1],["ma",1],["do",1],["fo",1],["aero",1],["company",1],["",1],["sex",1],["gg",1],["international",1],["lb",1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"location_suffix","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1523305346170,"submitTime":1523305346137,"finishTime":1523305346533,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"57715057-0f43-4ed9-a50b-a23cfb4b2421"},{"version":"CommandV1","origId":951645590912556,"guid":"b72b65b3-c804-4e9e-b84d-907a3177af1d","subtype":"command","commandType":"auto","position":8.985122680664062,"command":"suffixes = df_suffix.groupBy(\"location_suffix\").count().collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1523238186679,"submitTime":1523238186657,"finishTime":1523239024634,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b765d3fb-62e1-46c7-ac4c-5deab066caae"},{"version":"CommandV1","origId":951645590912557,"guid":"f2dbf842-3994-4bf5-bdd2-fc2eb7606823","subtype":"command","commandType":"auto","position":8.985649108886719,"command":"suffixes.sort(key = lambda x: x[1], reverse = True)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">IndexError</span>: tuple index out of range","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">IndexError</span>                                Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-4236989377965822&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>suffix_sorted <span class=\"ansiyellow\">=</span> suffixes<span class=\"ansiyellow\">.</span>sort<span class=\"ansiyellow\">(</span>key <span class=\"ansiyellow\">=</span> <span class=\"ansigreen\">lambda</span> x<span class=\"ansiyellow\">:</span> x<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">&lt;command-4236989377965822&gt;</span> in <span class=\"ansicyan\">&lt;lambda&gt;</span><span class=\"ansiblue\">(x)</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>suffix_sorted <span class=\"ansiyellow\">=</span> suffixes<span class=\"ansiyellow\">.</span>sort<span class=\"ansiyellow\">(</span>key <span class=\"ansiyellow\">=</span> <span class=\"ansigreen\">lambda</span> x<span class=\"ansiyellow\">:</span> x<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/types.py</span> in <span class=\"ansicyan\">__getitem__</span><span class=\"ansiblue\">(self, item)</span>\n<span class=\"ansigreen\">   1558</span>     <span class=\"ansigreen\">def</span> __getitem__<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1559</span>         <span class=\"ansigreen\">if</span> isinstance<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">(</span>int<span class=\"ansiyellow\">,</span> slice<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1560</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> super<span class=\"ansiyellow\">(</span>Row<span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>__getitem__<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1561</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1562</span>             <span class=\"ansired\"># it will be slow when it has many fields,</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">IndexError</span>: tuple index out of range</div>","workflows":[],"startTime":1523239595484,"submitTime":1523239595458,"finishTime":1523239595503,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"719cce17-df38-4bb9-b3d9-c3123dacc67f"},{"version":"CommandV1","origId":951645590912558,"guid":"6530ff41-4a03-44d7-9c84-11133f701893","subtype":"command","commandType":"auto","position":8.985912322998047,"command":"display(suffixes)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["com",64996246],["net",7870906],["ru",6949846],["de",3172804],["cn",1960922],["fr",1841548],["jp",1743689],["uk",1520819],["au",1368430],["pl",1298038],["vn",1276253],["org",1234238],["it",1196606],["br",1025864],["es",1021014],["ch",946699],["edu",923617],["ca",787324],["tv",750624],["kr",736241],["tr",514118],["id",508084],["in",506018],["tw",496793],["me",422616],["ke",379178],["ua",360453],["ma",359207],["gov",331150],["my",260328],["co",249152],["gr",246479],["gg",242878],["cc",231723],["sg",225930],["bnpparibas",219544],["network",199375],["ng",191169],["ph",178640],["at",176614],["th",175555],["hk",170501],["pt",167159],["eg",166324],["pk",162105],["za",158019],["io",153029],["bd",146169],["il",140389],["ro",139590],["to",135461],["fi",130362],["sk",123883],["eu",120965],["mx",100788],["cz",98976],["ws",97004],["az",96506],["ir",96344],["ar",90011],["mm",87758],["hu",81110],["pro",79043],["no",75724],["kz",75406],["be",74001],["info",67478],["se",66632],["pe",62949],["ie",59229],["nz",53908],["fm",49730],["cl",48319],["by",47967],["cat",47397],["biz",46958],["top",45615],["al",44073],["dk",42838],["lt",42548],["lol",40596],["su",40157],["nl",39958],["sncf",36726],["sc",30850],["sa",30461],["mk",29839],["club",29066],["ve",26994],["mobi",26573],["uz",26224],["hr",24008],["sexy",23139],["ee",21286],["us",21209],["lv",19828],["im",19016],["nu",17519],["ao",15198],["is",14844],["bg",12683],["ni",12606],["cu",10481],["bz",10168],["space",10052],["int",8771],["ag",8372],["ac",8337],["ec",8322],["gt",8189],["rs",7654],["media",7287],["name",7262],["la",6849],["mu",6690],["lk",6641],["sx",6618],["money",5781],["video",5755],["zone",5715],["lat",5621],["news",5498],["watch",5443],["do",5319],["uy",5304],["wiki",5080],["today",5047],["cr",5031],["ba",4830],["si",4818],["canon",4646],["re",4488],["tn",4385],["jobs",4251],["blog",4104],["porn",4050],["mil",3916],["li",3700],["site",3548],["guru",3479],["digital",3477],["ae",3378],["tf",3316],["mn",3300],["pa",3223],["@D",3091],["xyz",3031],["stream",2798],["159",2674],["kw",2665],["vc",2545],["live",2459],["am",2421],["plus",2359],["cy",2347],["lu",2120],["md",2120],["date",2063],["ly",2020],["jo",2014],["link",1972],["asia",1962],["ci",1910],["xxx",1866],["black",1794],["sv",1779],["np",1765],["pw",1514],["mg",1410],["bo",1360],["gh",1319],["py",1230],["kh",1144],["website",1117],["help",1109],["mt",1068],["hn",1053],["qa",1038],["pr",961],["host",953],["dz",941],["center",936],["earth",906],["lb",890],["cm",850],["tc",848],["om",824],["ug",792],["software",766],["na",766],["tt",763],["dhl",761],["zm",753],["af",753],["sn",749],["38:8087",744],["tz",744],["adult",736],["bw",726],["ml",708],["fo",699],["cd",697],["rw",686],["jm",680],["cern",669],["st",654],["pink",642],["download",640],["bh",632],["td",631],["rip",628],["mz",626],["java",610],["ht",601],["bn",595],["pg",570],["careers",563],["foundation",545],["dj",541],["tm",537],["shop",532],["cg",521],["et",520],["tj",519],["city",513],["academy",502],["bf",498],["win",497],["best",494],["online",489],["jcb",488],["chat",487],["ge",482],["aero",480],["95:13123",478],["realtor",449],["football",445],["gp",423],["bj",418],["iq",399],["bs",388],["barclays",358],["tk",357],["tech",354],["webcam",323],["cafe",320],["sh",301],["exchange",298],["mq",293],["expert",283],["deals",264],["so",258],["vip",256],["ai",255],["sky",239],["ad",232],["marketing",223],["ink",223],["mw",216],["agency",212],["net:51511",210],["149",195],["uol",191],["reviews",191],["sex",182],["cash",181],["cards",181],["travel",180],["nyc",180],["zw",177],["community",175],["google",172],["one",168],["moscow",162],["cx",162],["A",159],["",159],["education",158],["sz",156],["scot",153],["aws",151],["ls",149],["pm",148],["ga",148],["domains",143],["love",143],["casino",140],["ne",136],["br:81",123],["gi",121],["nc",106],["gm",102],["trade",98],["cv",88],["global",87],["career",83],["gq",81],["yt",77],["gs",74],["world",74],["tl",69],["gift",65],["plumbing",64],["buzz",64],["137",64],["solutions",63],["mo",63],["kr:447",62],["cn:8280",60],["uno",60],["guide",60],["pk:9090",60],["165",60],["ooo",59],["gratis",59],["sl",57],["market",57],["game",56],["cat:8081",56],["tokyo",55],["pe:8888",53],["kg",53],["200",52],["=0H5-",52],["fj",52],["156",52],["business",52],["rocks",52],["store",50],["172",50],["tools",50],["cn:8080",47],["tr:8181",47],["gl",43],["bb",43],["bm",43],["cw",43],["cf",43],["ky",43],["poker",43],["social",41],["design",41],["je",39],["wang",38],["in:8080",35],["place",34],["ltd",33],["farm",32],["gmbh",32],["cloud",30],["bid",30],["158",30],["com:447",30],["227:8898",29],["pf",29],["cn:81",28],["5",27],["click",26],["36",26],["ke:73",26],["com:9101",25],["london",24],["ps",23],["gf",22],["bio",22],["42",21],["com:8079",21],["16",19],["86",19],["com:9001",18],["cool",18],["131:88",17],["5:88",17],["135:88",17],["gal",16],["142",16],["pictures",15],["pharmacy",15],["cn:8283",15],["run",15],["109:9090",14],["gy",14],["com:90",13],["bi",13],["sale",12],["cn:8281",11],["163",11],["9",11],["mr",10],["146:81",10],["com:8100",10],["ye",9],["press",9],["fund",9],["com:8080",8],["45:7010",8],["73",7],["170:7778",7],["com:8001",7],["nico",7],["com:83",6],["107:8085",6],["post",6],["36:8081",6],["hamburg",5],["studio",5],["cn:13225",5],["sbi",5],["227:8080",4],["cn:8888",4],["245",4],["tg",4],["delivery",4],["to:8080",4],["company",4],["ca:8080",4],["international",4],["50",4],["globo",3],["vg",3],["ms",3],["support",3],["38",3],["kr:40018",3],["edu:8443",3],["com:6060",3],["net:441",3],["bike",3],["239:9002",2],["cn:8083",2],["36:8999",2],["18",2],["science",2],["org:5280",2],["systems",2],["cn:9080",2],["3",1],["9:2333",1],["net:7008",1],["120",1],["in:8443",1],["basketball",1],["life",1],["95",1],["cn:7700",1],["114",1],["cn:8099",1],["net:8080",1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"location_suffix","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1523241865525,"submitTime":1523241865497,"finishTime":1523241865869,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9b42192c-9a8b-415a-b20c-f5ca12c270c6"},{"version":"CommandV1","origId":951645590912559,"guid":"9390638c-45c4-4c1b-9b52-ec791b496255","subtype":"command","commandType":"auto","position":8.985978126525879,"command":"display(suffixes_unique)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["com",43960],["cn",7397],["net",3724],["edu",2997],["org",2768],["ru",2492],["jp",2018],["de",1446],["br",1045],["fr",921],["it",891],["pl",780],["uk",740],["tw",729],["in",719],["ca",715],["kr",630],["es",619],["au",499],["tv",492],["hu",459],["gov",451],["sk",432],["cz",432],["ua",372],["co",351],["gr",332],["io",288],["tr",275],["ch",264],["il",243],["sa",237],["at",237],["hk",234],["id",224],["mx",212],["me",207],["pt",206],["cc",194],["vn",190],["ar",172],["be",171],["biz",156],["ro",150],["nl",147],["no",144],["za",143],["info",137],["dk",132],["sg",129],["se",129],["pk",128],["cl",124],["eu",116],["us",113],["fi",110],["ve",108],["nz",108],["pe",103],["ir",101],["ie",96],["bg",91],["az",90],["cat",88],["by",83],["kz",82],["hr",78],["ng",78],["my",76],["ee",75],["lt",73],["to",72],["lv",69],["th",63],["lol",60],["fm",52],["ao",50],["eg",45],["ph",45],["ma",44],["ke",40],["lk",38],["si",37],["la",35],["do",34],["rs",33],["mk",33],["ec",30],["ws",29],["ae",27],["pro",27],["club",27],["xxx",26],["al",26],["news",25],["mu",25],["bd",25],["im",24],["uz",23],["tk",23],["uy",23],["is",21],["ml",21],["jobs",21],["gg",21],["kh",19],["jo",18],["media",18],["mil",18],["pa",18],["nu",17],["su",17],["cr",16],["mm",16],["@D",16],["ni",15],["int",15],["np",15],["ci",15],["lu",15],["online",14],["mobi",14],["ly",14],["cy",14],["xyz",13],["sv",13],["sncf",12],["live",12],["py",12],["pw",11],["gt",11],["cd",10],["hn",10],["am",10],["pr",9],["ba",9],["kw",9],["re",9],["bz",9],["wiki",9],["help",9],["dz",9],["porn",8],["top",8],["bo",8],["digital",8],["tn",8],["ga",8],["lb",8],["travel",7],["space",7],["sh",7],["qa",7],["network",7],["sc",7],["mt",7],["video",7],["gh",7],["asia",7],["mz",6],["ge",6],["zm",6],["mg",6],["rw",6],["cm",6],["cern",6],["blog",6],["cu",6],["fo",6],["tz",6],["na",6],["bw",5],["stream",5],["ag",5],["nyc",5],["st",5],["sx",5],["tt",5],["site",5],["vc",5],["mn",5],["cf",5],["sn",5],["li",5],["ug",5],["tech",5],["name",4],["com:8080",4],["shop",4],["bnpparibas",4],["money",4],["today",4],["pm",4],["zw",4],["af",4],["jm",4],["host",4],["gp",4],["ac",4],["website",4],["ht",4],["barclays",4],["vip",4],["aero",4],["om",4],["md",4],["bh",4],["mw",4],["cn:8080",3],["tf",3],["tl",3],["tm",3],["mq",3],["careers",3],["chat",3],["download",3],["realtor",3],["city",3],["zone",3],["ls",3],["bn",3],["date",3],["trade",3],["world",3],["bs",3],["ai",3],["so",3],["sz",3],["tokyo",2],["sl",2],["cv",2],["domains",2],["plumbing",2],["agency",2],["community",2],["gq",2],["gm",2],["je",2],["one",2],["moscow",2],["td",2],["cash",2],["link",2],["rip",2],["canon",2],["gf",2],["mr",2],["guru",2],["fj",2],["adult",2],["pink",2],["cloud",2],["yt",2],["gi",2],["nc",2],["pf",2],["kg",2],["cx",2],["store",2],["systems",2],["pg",2],["165",2],["best",2],["webcam",2],["et",2],["bf",2],["aws",2],["ltd",2],["center",2],["game",2],["reviews",2],["sex",2],["cg",2],["google",2],["mo",2],["globo",1],["net:51511",1],["watch",1],["farm",1],["pe:8888",1],["ye",1],["academy",1],["com:9001",1],["com:90",1],["ooo",1],["ne",1],["200",1],["ps",1],["cn:8281",1],["cn:8280",1],["dhl",1],["42",1],["uol",1],["73",1],["pictures",1],["gratis",1],["3",1],["239:9002",1],["9:2333",1],["net:7008",1],["wang",1],["=0H5-",1],["jcb",1],["vg",1],["press",1],["expert",1],["131:88",1],["16",1],["109:9090",1],["uno",1],["education",1],["cn:8083",1],["sexy",1],["gal",1],["fund",1],["love",1],["guide",1],["gl",1],["36:8999",1],["38:8087",1],["ms",1],["5",1],["iq",1],["163",1],["18",1],["plus",1],["solutions",1],["120",1],["earth",1],["227:8898",1],["lat",1],["software",1],["45:7010",1],["casino",1],["com:83",1],["marketing",1],["170:7778",1],["basketball",1],["ink",1],["in:8443",1],["227:8080",1],["london",1],["life",1],["hamburg",1],["pharmacy",1],["gs",1],["global",1],["bb",1],["bio",1],["dj",1],["science",1],["cn:8888",1],["bid",1],["support",1],["95",1],["38",1],["social",1],["sky",1],["146:81",1],["football",1],["156",1],["ad",1],["95:13123",1],["foundation",1],["A",1],["studio",1],["tj",1],["pk:9090",1],["sale",1],["br:81",1],["org:5280",1],["245",1],["cn:8283",1],["cards",1],["bm",1],["tg",1],["win",1],["86",1],["cn:13225",1],["click",1],["cn:7700",1],["com:8079",1],["gmbh",1],["114",1],["kr:40018",1],["cn:81",1],["edu:8443",1],["cw",1],["tr:8181",1],["delivery",1],["exchange",1],["market",1],["159",1],["158",1],["deals",1],["9",1],["to:8080",1],["149",1],["bj",1],["com:8001",1],["cn:8099",1],["black",1],["142",1],["bi",1],["kr:447",1],["36",1],["com:6060",1],["cafe",1],["107:8085",1],["in:8080",1],["gift",1],["buzz",1],["ke:73",1],["5:88",1],["172",1],["tc",1],["run",1],["company",1],["career",1],["net:441",1],["java",1],["nico",1],["ky",1],["tools",1],["poker",1],["",1],["post",1],["scot",1],["net:8080",1],["business",1],["135:88",1],["com:9101",1],["com:8100",1],["36:8081",1],["137",1],["rocks",1],["com:447",1],["bike",1],["ca:8080",1],["design",1],["cat:8081",1],["cn:9080",1],["international",1],["place",1],["gy",1],["cool",1],["50",1],["sbi",1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"location_suffix","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1523306314202,"submitTime":1523306314181,"finishTime":1523306314531,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f0b376ed-eea0-46c6-bc7a-0f6d190d6aeb"},{"version":"CommandV1","origId":951645590912560,"guid":"4efa8e50-cf71-4632-bb14-b7bd1a053dda","subtype":"command","commandType":"auto","position":8.986043930053711,"command":"percentages = []\nfor i in range(0,30):\n  for session_replay_suffix_row in suffixes_session_replay:\n    if suffixes[i][0] == session_replay_suffix_row[0]:\n      percentages.append([suffixes[i][0], session_replay_suffix_row[1]/ suffixes[i][1]])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;command-4236989377965830&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">4</span>\n<span class=\"ansiyellow\">    if suffixes[i][0] == session_replay_suffix_row[0]</span>\n<span class=\"ansigrey\">                                                     ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1523242646370,"submitTime":1523242646345,"finishTime":1523242646403,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2b92591f-7b6c-48e6-8f9e-1a63133d5b83"},{"version":"CommandV1","origId":951645590912561,"guid":"fe8028ec-ac71-4b1e-ba44-76e23028f7a2","subtype":"command","commandType":"auto","position":8.986109733581543,"command":"percentages","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">61</span><span class=\"ansired\">]: </span>\n[[&apos;suffix&apos;, &apos;probability of a call being a session replay call&apos;],\n [&apos;com&apos;, 0.021443023032437905],\n [&apos;net&apos;, 0.020723535511667907],\n [&apos;ru&apos;, 0.27918604239575956],\n [&apos;de&apos;, 0.008911675603031261],\n [&apos;cn&apos;, 0.0002554920593475926],\n [&apos;fr&apos;, 0.002213355285879054],\n [&apos;jp&apos;, 0.007620051511479398],\n [&apos;uk&apos;, 0.004300314501594207],\n [&apos;au&apos;, 0.023315039863200895],\n [&apos;pl&apos;, 0.003083114669986549],\n [&apos;vn&apos;, 0.013336697347626216],\n [&apos;org&apos;, 0.034575179179380314],\n [&apos;it&apos;, 0.014046394552592916],\n [&apos;br&apos;, 0.01671371643804637],\n [&apos;es&apos;, 0.018074188992511366],\n [&apos;ch&apos;, 0.000272525903164575],\n [&apos;edu&apos;, 0.02155438888630244],\n [&apos;ca&apos;, 0.007512790160086572],\n [&apos;tv&apos;, 0.09267622671270836],\n [&apos;kr&apos;, 0.0031199023145953566],\n [&apos;tr&apos;, 0.06384526509478369],\n [&apos;id&apos;, 0.0009663756386739201],\n [&apos;in&apos;, 0.018957823634732363],\n [&apos;tw&apos;, 0.003796349787537264],\n [&apos;me&apos;, 0.08793562004278116],\n [&apos;ke&apos;, 0.0017010480565855615],\n [&apos;ua&apos;, 0.07087470488524163],\n [&apos;ma&apos;, 9.743685395885938e-05],\n [&apos;gov&apos;, 0.015576022950324626],\n [&apos;my&apos;, 0.0052241787283734365]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1523242609274,"submitTime":1523242609249,"finishTime":1523242609291,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"309e860b-9191-4f08-9b04-e9320705fce6"},{"version":"CommandV1","origId":951645590912562,"guid":"115b15e1-b806-41fd-a501-30433413bc1e","subtype":"command","commandType":"auto","position":8.986142635345459,"command":"display(percentages)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["com",0.021443023032437905],["net",0.020723535511667907],["ru",0.27918604239575956],["de",0.008911675603031261],["cn",2.554920593475926E-4],["fr",0.002213355285879054],["jp",0.007620051511479398],["uk",0.004300314501594207],["au",0.023315039863200895],["pl",0.003083114669986549],["vn",0.013336697347626216],["org",0.034575179179380314],["it",0.014046394552592916],["br",0.01671371643804637],["es",0.018074188992511366],["ch",2.72525903164575E-4],["edu",0.02155438888630244],["ca",0.007512790160086572],["tv",0.09267622671270836],["kr",0.0031199023145953566],["tr",0.06384526509478369],["id",9.663756386739201E-4],["in",0.018957823634732363],["tw",0.003796349787537264],["me",0.08793562004278116],["ke",0.0017010480565855615],["ua",0.07087470488524163],["ma",9.743685395885938E-5],["gov",0.015576022950324626],["my",0.0052241787283734365]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"_1","type":"\"string\"","metadata":"{}"},{"name":"_2","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1523242657877,"submitTime":1523242657851,"finishTime":1523242658190,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"1247","height":"262","xColumns":["_1"],"yColumns":["_2"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"034e4cc8-5a78-4a7c-be82-23ddd2474a28"},{"version":"CommandV1","origId":951645590912563,"guid":"7c15536f-8c62-4ade-b3c3-157c48eb5cf0","subtype":"command","commandType":"auto","position":8.986159086227417,"command":"percentages_unique = []\nfor i in range(0,30):\n  for session_replay_site in suffixes_session_replay_unique:\n    if suffixes_unique[i][0] == session_replay_site[0]:\n      percentages_unique.append([suffixes_unique[i][0], session_replay_site[1]/ suffixes_unique[i][1]])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1523306432928,"submitTime":1523306432899,"finishTime":1523306432961,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"423a6792-6826-433a-b236-69446175b77a"},{"version":"CommandV1","origId":951645590912564,"guid":"73b462d8-95a2-47e6-b600-0fc30708d9a1","subtype":"command","commandType":"auto","position":8.986167311668396,"command":"percentages_unique","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">21</span><span class=\"ansired\">]: </span>\n[[&apos;com&apos;, 0.03955868971792539],\n [&apos;cn&apos;, 0.000675949709341625],\n [&apos;net&apos;, 0.027121374865735768],\n [&apos;edu&apos;, 0.03203203203203203],\n [&apos;org&apos;, 0.02384393063583815],\n [&apos;ru&apos;, 0.6556982343499197],\n [&apos;jp&apos;, 0.007928642220019821],\n [&apos;de&apos;, 0.025587828492392807],\n [&apos;br&apos;, 0.05167464114832536],\n [&apos;fr&apos;, 0.029315960912052116],\n [&apos;it&apos;, 0.050505050505050504],\n [&apos;pl&apos;, 0.03974358974358974],\n [&apos;uk&apos;, 0.06891891891891892],\n [&apos;tw&apos;, 0.009602194787379973],\n [&apos;in&apos;, 0.02086230876216968],\n [&apos;ca&apos;, 0.03776223776223776],\n [&apos;kr&apos;, 0.004761904761904762],\n [&apos;es&apos;, 0.051696284329563816],\n [&apos;au&apos;, 0.06212424849699399],\n [&apos;tv&apos;, 0.13211382113821138],\n [&apos;hu&apos;, 0.05010893246187364],\n [&apos;gov&apos;, 0.017738359201773836],\n [&apos;sk&apos;, 0.10185185185185185],\n [&apos;cz&apos;, 0.04398148148148148],\n [&apos;ua&apos;, 0.17204301075268819],\n [&apos;co&apos;, 0.02564102564102564],\n [&apos;gr&apos;, 0.0572289156626506],\n [&apos;io&apos;, 0.034722222222222224],\n [&apos;tr&apos;, 0.19636363636363635],\n [&apos;ch&apos;, 0.026515151515151516]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1523306439104,"submitTime":1523306439083,"finishTime":1523306439120,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"58e26c0d-a6a4-426a-8548-e3f9b83e3db6"},{"version":"CommandV1","origId":951645590912565,"guid":"d78f4da3-db34-4973-87ac-89764a9fb2f8","subtype":"command","commandType":"auto","position":8.986171424388885,"command":"display(percentages_unique)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["com",0.03955868971792539],["cn",6.75949709341625E-4],["net",0.027121374865735768],["edu",0.03203203203203203],["org",0.02384393063583815],["ru",0.6556982343499197],["jp",0.007928642220019821],["de",0.025587828492392807],["br",0.05167464114832536],["fr",0.029315960912052116],["it",0.050505050505050504],["pl",0.03974358974358974],["uk",0.06891891891891892],["tw",0.009602194787379973],["in",0.02086230876216968],["ca",0.03776223776223776],["kr",0.004761904761904762],["es",0.051696284329563816],["au",0.06212424849699399],["tv",0.13211382113821138],["hu",0.05010893246187364],["gov",0.017738359201773836],["sk",0.10185185185185185],["cz",0.04398148148148148],["ua",0.17204301075268819],["co",0.02564102564102564],["gr",0.0572289156626506],["io",0.034722222222222224],["tr",0.19636363636363635],["ch",0.026515151515151516]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"_1","type":"\"string\"","metadata":"{}"},{"name":"_2","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1523306456920,"submitTime":1523306456899,"finishTime":1523306457281,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"1146","height":"256","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"038f57d2-469b-4c05-904e-63efc4734602"},{"version":"CommandV1","origId":951645590912566,"guid":"3926ef5b-a175-4d95-bbb1-3af70a49bcff","subtype":"command","commandType":"auto","position":8.986175537109375,"command":"df_suffix.filter(df_suffix.location_suffix == \"ru\").count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">31</span><span class=\"ansired\">]: </span>6949846\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;df_suffix&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-4167030868715854&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>df_suffix<span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span>df_suffix<span class=\"ansiyellow\">.</span>location_suffix <span class=\"ansiyellow\">==</span> <span class=\"ansiblue\">&quot;ru&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>count<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;df_suffix&apos; is not defined</div>","workflows":[],"startTime":1522875405795,"submitTime":1522875405772,"finishTime":1522876212921,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3cc3c7c5-a709-4875-92a3-e0cb9b58bfa4"},{"version":"CommandV1","origId":951645590912567,"guid":"771a9c7b-104a-442b-b63e-4e07b4e2631d","subtype":"command","commandType":"auto","position":8.987228393554688,"command":"df_suffix.filter(df_suffix.location_suffix == \"ru\").dropDuplicates(['base_location_url']).count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">18</span><span class=\"ansired\">]: </span>2492\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;df_suffix&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-4167030868715857&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>df_suffix<span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span>df_suffix<span class=\"ansiyellow\">.</span>location_suffix <span class=\"ansiyellow\">==</span> <span class=\"ansiblue\">&quot;ru&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>dropDuplicates<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;base_location_url&apos;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>count<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;df_suffix&apos; is not defined</div>","workflows":[],"startTime":1522894211442,"submitTime":1522894211428,"finishTime":1522895292553,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ac4a78ab-8ac2-4180-9980-e69763b6cfec"},{"version":"CommandV1","origId":951645590912568,"guid":"ab70fd8f-b5de-4dbf-85b2-9d0b2f107d30","subtype":"command","commandType":"auto","position":8.987754821777344,"command":"session_suffix = df_suffix.filter(df_suffix.script_url.rlike(url_string))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"session_suffix","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"argument_0","nullable":true,"type":"string"},{"metadata":{},"name":"argument_1","nullable":true,"type":"string"},{"metadata":{},"name":"argument_2","nullable":true,"type":"string"},{"metadata":{},"name":"argument_3","nullable":true,"type":"string"},{"metadata":{},"name":"argument_4","nullable":true,"type":"string"},{"metadata":{},"name":"argument_5","nullable":true,"type":"string"},{"metadata":{},"name":"argument_6","nullable":true,"type":"string"},{"metadata":{},"name":"argument_7","nullable":true,"type":"string"},{"metadata":{},"name":"argument_8","nullable":true,"type":"string"},{"metadata":{},"name":"arguments","nullable":true,"type":"string"},{"metadata":{},"name":"arguments_n_keys","nullable":true,"type":"long"},{"metadata":{},"name":"call_id","nullable":true,"type":"string"},{"metadata":{},"name":"call_stack","nullable":true,"type":"string"},{"metadata":{},"name":"crawl_id","nullable":true,"type":"long"},{"metadata":{},"name":"file_name","nullable":true,"type":"string"},{"metadata":{},"name":"func_name","nullable":true,"type":"string"},{"metadata":{},"name":"in_iframe","nullable":true,"type":"boolean"},{"metadata":{},"name":"location","nullable":true,"type":"string"},{"metadata":{},"name":"operation","nullable":true,"type":"string"},{"metadata":{},"name":"script_col","nullable":true,"type":"string"},{"metadata":{},"name":"script_line","nullable":true,"type":"string"},{"metadata":{},"name":"script_loc_eval","nullable":true,"type":"string"},{"metadata":{},"name":"script_url","nullable":true,"type":"string"},{"metadata":{},"name":"symbol","nullable":true,"type":"string"},{"metadata":{},"name":"time_stamp","nullable":true,"type":"timestamp"},{"metadata":{},"name":"value","nullable":true,"type":"string"},{"metadata":{},"name":"value_1000","nullable":true,"type":"string"},{"metadata":{},"name":"value_len","nullable":true,"type":"integer"},{"metadata":{},"name":"valid","nullable":true,"type":"boolean"},{"metadata":{},"name":"errors","nullable":true,"type":"string"},{"metadata":{},"name":"base_script_url","nullable":true,"type":"string"},{"metadata":{},"name":"base_location_url","nullable":true,"type":"string"},{"metadata":{},"name":"location_suffix","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;df_with_scheme&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-313033179106629&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>session_suffix <span class=\"ansiyellow\">=</span> df_suffix<span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span>df_with_scheme<span class=\"ansiyellow\">.</span>script_url<span class=\"ansiyellow\">.</span>rlike<span class=\"ansiyellow\">(</span>url_string<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;df_with_scheme&apos; is not defined</div>","workflows":[],"startTime":1522944609536,"submitTime":1522944609508,"finishTime":1522944609570,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6c5881ba-d708-43fa-bd02-02de97c9558c"},{"version":"CommandV1","origId":951645590912569,"guid":"20810b78-59f1-43d8-ac4c-b552520db1bd","subtype":"command","commandType":"auto","position":8.988018035888672,"command":"session_suffix.filter(df_suffix.location_suffix == \"ru\").count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">19</span><span class=\"ansired\">]: </span>1940300\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1522941887031,"submitTime":1522941887007,"finishTime":1522943127200,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"36a02aa6-c192-4dcc-a916-1318c1cbb1e3"},{"version":"CommandV1","origId":951645590912570,"guid":"261dc4ec-0017-47bd-9f2b-d724be168dea","subtype":"command","commandType":"auto","position":8.988149642944336,"command":"session_suffix.filter(df_suffix.location_suffix == \"ru\").dropDuplicates(['base_location_url']).count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">19</span><span class=\"ansired\">]: </span>1634\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 7 in stage 15.0 failed 1 times, most recent failure: Lost task 7.0 in stage 15.0 (TID 2283, localhost, executor driver): org.apache.spark.repl.RemoteClassLoaderError: org/apache/spark/sql/catalyst/expressions/Object.class","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-313033179106631&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>session_suffix<span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span>df_suffix<span class=\"ansiyellow\">.</span>location_suffix <span class=\"ansiyellow\">==</span> <span class=\"ansiblue\">&quot;ru&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>dropDuplicates<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;base_location_url&apos;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>count<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">count</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">    428</span>         <span class=\"ansicyan\">2</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    429</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 430</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> int<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>count<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    431</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    432</span>     <span class=\"ansiyellow\">@</span>ignore_unicode_prefix<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    317</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    318</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 319</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o470.count.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 7 in stage 15.0 failed 1 times, most recent failure: Lost task 7.0 in stage 15.0 (TID 2283, localhost, executor driver): org.apache.spark.repl.RemoteClassLoaderError: org/apache/spark/sql/catalyst/expressions/Object.class\n\tat org.apache.spark.repl.ExecutorClassLoader$$anon$1.toClassNotFound(ExecutorClassLoader.scala:119)\n\tat org.apache.spark.repl.ExecutorClassLoader$$anon$1.read(ExecutorClassLoader.scala:107)\n\tat java.io.FilterInputStream.read(FilterInputStream.java:107)\n\tat org.apache.spark.repl.ExecutorClassLoader.readAndTransformClass(ExecutorClassLoader.scala:223)\n\tat org.apache.spark.repl.ExecutorClassLoader.findClassLocally(ExecutorClassLoader.scala:177)\n\tat org.apache.spark.repl.ExecutorClassLoader.findClass(ExecutorClassLoader.scala:81)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:411)\n\tat org.apache.spark.util.ParentClassLoader.loadClass(ParentClassLoader.scala:34)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\tat org.apache.spark.util.ParentClassLoader.loadClass(ParentClassLoader.scala:30)\n\tat java.lang.Class.forName0(Native Method)\n\tat java.lang.Class.forName(Class.java:348)\n\tat org.codehaus.janino.ClassLoaderIClassLoader.findIClass(ClassLoaderIClassLoader.java:83)\n\tat org.codehaus.janino.IClassLoader.loadIClass(IClassLoader.java:288)\n\tat org.codehaus.janino.UnitCompiler.findTypeByName(UnitCompiler.java:7611)\n\tat org.codehaus.janino.UnitCompiler.getReferenceType(UnitCompiler.java:5906)\n\tat org.codehaus.janino.UnitCompiler.getReferenceType(UnitCompiler.java:5751)\n\tat org.codehaus.janino.UnitCompiler.getType2(UnitCompiler.java:5732)\n\tat org.codehaus.janino.UnitCompiler.access$13200(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$18.visitReferenceType(UnitCompiler.java:5668)\n\tat org.codehaus.janino.UnitCompiler$18.visitReferenceType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.Java$ReferenceType.accept(Java.java:3356)\n\tat org.codehaus.janino.UnitCompiler.getType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.UnitCompiler.getType2(UnitCompiler.java:6007)\n\tat org.codehaus.janino.UnitCompiler.access$13000(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$18.visitArrayType(UnitCompiler.java:5666)\n\tat org.codehaus.janino.UnitCompiler$18.visitArrayType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.Java$ArrayType.accept(Java.java:3425)\n\tat org.codehaus.janino.UnitCompiler.getType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.UnitCompiler.access$1200(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$32.getParameterTypes2(UnitCompiler.java:9326)\n\tat org.codehaus.janino.IClass$IInvocable.getParameterTypes(IClass.java:853)\n\tat org.codehaus.janino.IClass$IMethod.getDescriptor2(IClass.java:1084)\n\tat org.codehaus.janino.IClass$IInvocable.getDescriptor(IClass.java:865)\n\tat org.codehaus.janino.IClass.getIMethods(IClass.java:211)\n\tat org.codehaus.janino.IClass.getIMethods(IClass.java:200)\n\tat org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:439)\n\tat org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:420)\n\tat org.codehaus.janino.UnitCompiler.access$400(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:374)\n\tat org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:369)\n\tat org.codehaus.janino.Java$AbstractPackageMemberClassDeclaration.accept(Java.java:1309)\n\tat org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:369)\n\tat org.codehaus.janino.UnitCompiler.compileUnit(UnitCompiler.java:345)\n\tat org.codehaus.janino.SimpleCompiler.compileToClassLoader(SimpleCompiler.java:396)\n\tat org.codehaus.janino.ClassBodyEvaluator.compileToClass(ClassBodyEvaluator.java:311)\n\tat org.codehaus.janino.ClassBodyEvaluator.cook(ClassBodyEvaluator.java:229)\n\tat org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:196)\n\tat org.codehaus.commons.compiler.Cookable.cook(Cookable.java:91)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.org$apache$spark$sql$catalyst$expressions$codegen$CodeGenerator$$doCompile(CodeGenerator.scala:1042)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1118)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1115)\n\tat com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3522)\n\tat com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2315)\n\tat com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2278)\n\tat com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2193)\n\tat com.google.common.cache.LocalCache.get(LocalCache.java:3932)\n\tat com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3936)\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4806)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.compile(CodeGenerator.scala:988)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:435)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:389)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:32)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator.generate(CodeGenerator.scala:968)\n\tat org.apache.spark.sql.catalyst.expressions.UnsafeProjection$.create(Projection.scala:130)\n\tat org.apache.spark.sql.execution.aggregate.HashAggregateExec.createHashMap(HashAggregateExec.scala:367)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$8$$anon$1.hasNext(WholeStageCodegenExec.scala:423)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:96)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:53)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:110)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:349)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: java.io.IOException: Connection reset by peer\n\tat sun.nio.ch.FileDispatcherImpl.read0(Native Method)\n\tat sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)\n\tat sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)\n\tat sun.nio.ch.IOUtil.read(IOUtil.java:192)\n\tat sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)\n\tat io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:221)\n\tat io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:899)\n\tat io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:275)\n\tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:119)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:643)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:566)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:480)\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:442)\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:131)\n\tat io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:144)\n\t... 1 more\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1683)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1671)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1670)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1670)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:931)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:931)\n\tat scala.Option.foreach(Option.scala:257)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:931)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1903)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1854)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1842)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:733)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2114)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2211)\n\tat org.apache.spark.sql.execution.collect.Collector.runSparkJobs(Collector.scala:206)\n\tat org.apache.spark.sql.execution.collect.Collector.collect(Collector.scala:241)\n\tat org.apache.spark.sql.execution.collect.Collector$.collect(Collector.scala:64)\n\tat org.apache.spark.sql.execution.collect.Collector$.collect(Collector.scala:70)\n\tat org.apache.spark.sql.execution.SparkPlan.executeCollectResult(SparkPlan.scala:264)\n\tat org.apache.spark.sql.execution.SparkPlan.executeCollect(SparkPlan.scala:255)\n\tat org.apache.spark.sql.Dataset$$anonfun$count$1.apply(Dataset.scala:2519)\n\tat org.apache.spark.sql.Dataset$$anonfun$count$1.apply(Dataset.scala:2518)\n\tat org.apache.spark.sql.Dataset$$anonfun$59.apply(Dataset.scala:3021)\n\tat org.apache.spark.sql.execution.SQLExecution$.withCustomExecutionEnv(SQLExecution.scala:89)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:127)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:3020)\n\tat org.apache.spark.sql.Dataset.count(Dataset.scala:2518)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:380)\n\tat py4j.Gateway.invoke(Gateway.java:293)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:226)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: org.apache.spark.repl.RemoteClassLoaderError: org/apache/spark/sql/catalyst/expressions/Object.class\n\tat org.apache.spark.repl.ExecutorClassLoader$$anon$1.toClassNotFound(ExecutorClassLoader.scala:119)\n\tat org.apache.spark.repl.ExecutorClassLoader$$anon$1.read(ExecutorClassLoader.scala:107)\n\tat java.io.FilterInputStream.read(FilterInputStream.java:107)\n\tat org.apache.spark.repl.ExecutorClassLoader.readAndTransformClass(ExecutorClassLoader.scala:223)\n\tat org.apache.spark.repl.ExecutorClassLoader.findClassLocally(ExecutorClassLoader.scala:177)\n\tat org.apache.spark.repl.ExecutorClassLoader.findClass(ExecutorClassLoader.scala:81)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:411)\n\tat org.apache.spark.util.ParentClassLoader.loadClass(ParentClassLoader.scala:34)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\tat org.apache.spark.util.ParentClassLoader.loadClass(ParentClassLoader.scala:30)\n\tat java.lang.Class.forName0(Native Method)\n\tat java.lang.Class.forName(Class.java:348)\n\tat org.codehaus.janino.ClassLoaderIClassLoader.findIClass(ClassLoaderIClassLoader.java:83)\n\tat org.codehaus.janino.IClassLoader.loadIClass(IClassLoader.java:288)\n\tat org.codehaus.janino.UnitCompiler.findTypeByName(UnitCompiler.java:7611)\n\tat org.codehaus.janino.UnitCompiler.getReferenceType(UnitCompiler.java:5906)\n\tat org.codehaus.janino.UnitCompiler.getReferenceType(UnitCompiler.java:5751)\n\tat org.codehaus.janino.UnitCompiler.getType2(UnitCompiler.java:5732)\n\tat org.codehaus.janino.UnitCompiler.access$13200(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$18.visitReferenceType(UnitCompiler.java:5668)\n\tat org.codehaus.janino.UnitCompiler$18.visitReferenceType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.Java$ReferenceType.accept(Java.java:3356)\n\tat org.codehaus.janino.UnitCompiler.getType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.UnitCompiler.getType2(UnitCompiler.java:6007)\n\tat org.codehaus.janino.UnitCompiler.access$13000(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$18.visitArrayType(UnitCompiler.java:5666)\n\tat org.codehaus.janino.UnitCompiler$18.visitArrayType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.Java$ArrayType.accept(Java.java:3425)\n\tat org.codehaus.janino.UnitCompiler.getType(UnitCompiler.java:5660)\n\tat org.codehaus.janino.UnitCompiler.access$1200(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$32.getParameterTypes2(UnitCompiler.java:9326)\n\tat org.codehaus.janino.IClass$IInvocable.getParameterTypes(IClass.java:853)\n\tat org.codehaus.janino.IClass$IMethod.getDescriptor2(IClass.java:1084)\n\tat org.codehaus.janino.IClass$IInvocable.getDescriptor(IClass.java:865)\n\tat org.codehaus.janino.IClass.getIMethods(IClass.java:211)\n\tat org.codehaus.janino.IClass.getIMethods(IClass.java:200)\n\tat org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:439)\n\tat org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:420)\n\tat org.codehaus.janino.UnitCompiler.access$400(UnitCompiler.java:206)\n\tat org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:374)\n\tat org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:369)\n\tat org.codehaus.janino.Java$AbstractPackageMemberClassDeclaration.accept(Java.java:1309)\n\tat org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:369)\n\tat org.codehaus.janino.UnitCompiler.compileUnit(UnitCompiler.java:345)\n\tat org.codehaus.janino.SimpleCompiler.compileToClassLoader(SimpleCompiler.java:396)\n\tat org.codehaus.janino.ClassBodyEvaluator.compileToClass(ClassBodyEvaluator.java:311)\n\tat org.codehaus.janino.ClassBodyEvaluator.cook(ClassBodyEvaluator.java:229)\n\tat org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:196)\n\tat org.codehaus.commons.compiler.Cookable.cook(Cookable.java:91)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.org$apache$spark$sql$catalyst$expressions$codegen$CodeGenerator$$doCompile(CodeGenerator.scala:1042)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1118)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1115)\n\tat com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3522)\n\tat com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2315)\n\tat com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2278)\n\tat com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2193)\n\tat com.google.common.cache.LocalCache.get(LocalCache.java:3932)\n\tat com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3936)\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4806)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.compile(CodeGenerator.scala:988)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:435)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:389)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:32)\n\tat org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator.generate(CodeGenerator.scala:968)\n\tat org.apache.spark.sql.catalyst.expressions.UnsafeProjection$.create(Projection.scala:130)\n\tat org.apache.spark.sql.execution.aggregate.HashAggregateExec.createHashMap(HashAggregateExec.scala:367)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$8$$anon$1.hasNext(WholeStageCodegenExec.scala:423)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:96)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:53)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:110)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:349)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\t... 1 more\nCaused by: java.io.IOException: Connection reset by peer\n\tat sun.nio.ch.FileDispatcherImpl.read0(Native Method)\n\tat sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)\n\tat sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)\n\tat sun.nio.ch.IOUtil.read(IOUtil.java:192)\n\tat sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)\n\tat io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:221)\n\tat io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:899)\n\tat io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:275)\n\tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:119)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:643)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:566)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:480)\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:442)\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:131)\n\tat io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:144)\n\t... 1 more\n</div>","workflows":[],"startTime":1522944612804,"submitTime":1522944612779,"finishTime":1522945843492,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c8aa344d-9a45-49bd-873d-ad6c107f28ec"}],"dashboards":[],"guid":"2c0c2362-8c73-4d81-9fce-6d2a4c42a6af","globalVars":{},"iPythonMetadata":{"nbformat":4,"IPythonMetadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"mimetype":"text/x-python","name":"python","pygments_lexer":"ipython3","codemirror_mode":{"name":"ipython","version":3},"version":"3.6.4","nbconvert_exporter":"python","file_extension":".py"}}},"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/js/metrics-graphics.js"
 onerror="window.mainJsLoadError = true;"></script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
